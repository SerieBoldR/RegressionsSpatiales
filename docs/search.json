[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "",
    "text": "Préface"
  },
  {
    "objectID": "index.html#sect001",
    "href": "index.html#sect001",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Un manuel sous la forme d’une ressource éducative libre",
    "text": "Un manuel sous la forme d’une ressource éducative libre\nPourquoi un manuel sous licence libre?\nLes logiciels libres sont aujourd’hui très répandus. Comparativement aux logiciels propriétaires, l’accès au code source permet à quiconque de l’utiliser, de le modifier, de le dupliquer et de le partager. Le logiciel R, dans lequel sont mises en œuvre les méthodes de régression spatiale décrites dans ce livre, est d’ailleurs à la fois un langage de programmation et un logiciel libre (sous la licence publique générale GNU GPL2). Par analogie aux logiciels libres, il existe aussi des ressources éducatives libres (REL) « dont la licence accorde les permissions désignées par les 5R (Retenir — Réutiliser — Réviser — Remixer — Redistribuer) et donc permet nécessairement la modification » (fabriqueREL). La licence de ce livre, CC BY-SA (figure 1), permet donc de :\n\nRetenir, c’est-à-dire télécharger et imprimer gratuitement le livre. Notez qu’il aurait été plutôt surprenant d’écrire un livre payant sur un logiciel libre et donc gratuit. Aussi, nous aurions été très embarrassés que des personnes étudiantes avec des ressources financières limitées doivent payer pour avoir accès au livre, sans pour autant savoir préalablement si le contenu est réellement adapté à leurs besoins.\nRéutiliser, c’est-à-dire utiliser la totalité ou une section du livre sans limitation et sans compensation financière. Cela permet ainsi à d’autres personnes enseignantes de l’utiliser dans le cadre d’activités pédagogiques.\nRéviser, c’est-à-dire modifier, adapter et traduire le contenu en fonction d’un besoin pédagogique précis puisqu’aucun manuel n’est parfait, tant s’en faut! Le livre a d’ailleurs été écrit intégralement dans R avec Quatro. Quiconque peut ainsi télécharger gratuitement le code source du livre sur github et le modifier à sa guise (voir l’encadré intitulé Suggestions d’adaptation du manuel).\nRemixer, c’est-à-dire « combiner la ressource avec d’autres ressources dont la licence le permet aussi pour créer une nouvelle ressource intégrée » (fabriqueREL).\nRedistribuer, c’est-à-dire distribuer, en totalité ou en partie le manuel ou une version révisée sur d’autres canaux que le site Web du livre (par exemple, sur le site Moodle de votre université ou en faire une version imprimée).\n\nLa licence de ce livre, CC BY-SA (figure 1), oblige donc à :\n\nAttribuer la paternité de l’auteur dans vos versions dérivées, ainsi qu’une mention concernant les grandes modifications apportées, en utilisant la formulation suivante : Apparicio Philippe et Jérémy Gelb (2024). Méthodes d’analyses spatiales : un grand bol d’R. Université de Sherbrooke. fabriqueREL. Licence CC BY-SA.\nUtiliser la même licence ou une licence similaire à toutes versions dérivées.\n\n\n\nFigure 1: Licence Creative Commons du livre\n\n\n\n\n\n\nSuggestions d’adaptation du manuel\n\n\nPour chaque méthode d’analyse spatiale abordée dans le livre, une description détaillée et une mise en œuvre dans R sont disponibles. Par conséquent, plusieurs adaptations du manuel sont possibles :\n\nConserver uniquement les chapitres sur les méthodes ciblées dans votre cours.\nEn faire une version imprimée et la distribuer aux personnes étudiantes.\nModifier la description d’une ou de plusieurs méthodes en effectuant les mises à jour directement dans les chapitres.\nInsérer ses propres jeux de données dans les sections intitulées Mise en œuvre dans R.\nModifier les tableaux et figures.\nAjouter une série d’exercices.\nModifier les quiz de révision.\nRédiger un nouveau chapitre.\nModifier des syntaxes R. Plusieurs packages R peuvent être utilisés pour mettre en œuvre telle ou telle méthode. Ces derniers évoluent aussi très vite et de nouveaux packages sont proposés fréquemment! Par conséquent, il peut être judicieux de modifier une syntaxe R du livre en fonction de ses habitudes de programmation dans R (utilisation d’autres packages que ceux utilisés dans le manuel par exemple) ou de bien mettre à jour une syntaxe à la suite de la parution d’un nouveau package plus performant ou intéressant.\nToute autre adaptation qui permet de répondre au mieux à un besoin pédagogique."
  },
  {
    "objectID": "index.html#sect002",
    "href": "index.html#sect002",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Comment lire ce manuel?",
    "text": "Comment lire ce manuel?\nLe livre comprend plusieurs types de blocs de texte qui en facilitent la lecture.\n\n\n\n\n\nBloc packages\n\n\nHabituellement localisé au début d’un chapitre, il comprend la liste des packages R utilisés pour un chapitre.\n\n\n\n\n\n\n\nBloc objectif\n\n\nIl comprend une description des objectifs d’un chapitre ou d’une section.\n\n\n\n\n\n\n\nBloc notes\n\n\nIl comprend une information secondaire sur une notion, une idée abordée dans une section.\n\n\n\n\n\n\n\nBloc pour aller plus loin\n\n\nIl comprend des références ou des extensions d’une méthode abordée dans une section.\n\n\n\n\n\n\n\nBloc astuce\n\n\nIl décrit un élément qui vous facilitera la vie : une propriété statistique, un package, une fonction, une syntaxe R.\n\n\n\n\n\n\n\nBloc attention\n\n\nIl comprend une notion ou un élément important à bien maîtriser.\n\n\n\n\n\n\n\nBloc exercice\n\n\nIl comprend un court exercice de révision à la fin de chaque chapitre."
  },
  {
    "objectID": "index.html#sect003",
    "href": "index.html#sect003",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Comment utiliser les données du livre pour reproduire les exemples?",
    "text": "Comment utiliser les données du livre pour reproduire les exemples?\nCe livre comprend des exemples détaillés et appliqués dans R pour chacune des méthodes abordées. Ces exemples se basent sur des jeux de données structurés et mis à disposition avec le livre. Ils sont disponibles sur le repo github dans le sous-dossier data, à l’adresse https://github.com/SerieBoldR/RegressionsSpatiales/tree/main/data.\nUne autre option est de télécharger le repo complet du livre directement sur github (https://github.com/SerieBoldR/RegressionsSpatiales) en cliquant sur le bouton Code, puis le bouton Download ZIP (figure 2). Les données se trouvent alors dans le sous-dossier nommé data.\n\n\nFigure 2: Téléchargement de l’intégralité du livre"
  },
  {
    "objectID": "index.html#sect004",
    "href": "index.html#sect004",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Liste des packages utilisés",
    "text": "Liste des packages utilisés\nDans ce livre, nous utilisons de nombreux packages R que vous pouvez installer avec le code ci-dessous.\n\n# Liste des packages\nListePackages &lt;- c(\"dplyr\", \"mgwrsar\", \"plm\", \"RColorBrewer\", \"rgeoda\", \"sf\", \"spatialreg\", \n                   \"spfilteR\", \"splm\", \"spdep\", \"spgwr\")\n# Packages non installés dans la liste\nPackagesNonInstalles &lt;- ListePackages[!(ListePackages %in% installed.packages()[,\"Package\"])]\n# Installation des packages manquants\nif(length(new.packages)) install.packages(PackagesNonInstalles)"
  },
  {
    "objectID": "index.html#sect005",
    "href": "index.html#sect005",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Structure du livre",
    "text": "Structure du livre\nLe livre est organisé autour de cinq grandes parties.\nPartie 1. Notions de base. Dans cette première partie, nous présentons les jeux de données utilisées pour mettre en œuvre les différentes méthodes de régression spatiale présentées dans le livre (chapitre 1). Nous discutons aussi de plusieurs notions fondamentales et méthodes qu’il importe de bien maîtriser avant d’aborder les chapitres suivants consacrés aux méthodes de régression spatiale, notamment : l’autocorrélation spatiale (globale et locale), la notion de variable spatialement décalée et la régression linéaire multiple. Nous conclurons ce chapitre en exposant les raisons qui justifient l’utilisation de différentes formes de régressions spatiales pour modéliser des données spatiales ou spatiotemporelles.\nPartie 2. Modèles d’économétrie spatiale. Cette seconde partie est consacrée aux modèles d’économétrie spatiale qui vise à modéliser la dépendance spatiale. Dans le chapitre 2, nous décrivons ainsi les principaux modèles spatiaux autorégressifs qui permettent d’introduire l’autocorrélation spatiale sur les variables indépendantes (modèle SLX), la variable dépendante (SAR), sur le terme d’erreur (SEM), à la fois sur la variable dépendante et les variables indépendantes (SDM) ou à la fois sur le sur les variables indépendantes et sur le terme d’erreur (SDEM). Dans le chapitre 3, nous abordons une extension des modèles autorégressifs, soit les modèles spatiaux par panel qui permettent de modéliser des données spatiales longitudinales.\nPartie 3. Régressions géographiquement pondérées. Dans cette partie, nous abordons les régressions géographiquement pondérées (GWR) qui permettent de modéliser l’hétérogénéité spatiale, soit l’instabilité des relations entre la variable dépendante et celles indépendantes. Premièrement, nous décrirons les formes dites classiques de la GWR qui s’appliquent à des variables dépendantes continues, dichotomiques (logistique) et de comptage (Poisson) (?sec-chap04). Deuxièmement, nous abordons des extensions des la GWR, particulièrement la GWR mixte, la GWR multiéchelle, la régression temporellement et géographiquement pondérée (GTWR) et les GWR mixtes avec des variables spatialement décalées (MGWR-SAR) (chapitre 4).\nPartie 4. Autres approches de modélisation spatiale. Dans cette dernière partie, nous abordons\nL’autocorrélation spatiale est une notion fondamentale en analyse spatiale permettant de vérifier si les entités proches ou voisines ont tendance à être (dis)semblables en fonction d’un phénomène donné. Dans le chapitre 2, nous décrivons une panoplie de méthodes permettant de définir des matrices de pondération spatiale qui sont utilisées pour évaluer la dépendance spatiale d’une ou de plusieurs variables, soit les mesures d’autocorrélation spatiale globale et locale. La compréhension de la notion de dépendance spatiale et des différentes mesures d’autocorrélation spatiale est primordiale puisqu’elles sont largement mobilisées dans d’autres méthodes d’analyses spatiales décrites dans les chapitres suivants, notamment les régressions spatiales (chapitre 2) et les méthodes de classification spatiale (chapitre 3).\nPartie 4. Autres modèles de régressions spatiales. Cette cinquième et dernière partie comprend deux chapitres. Le chapitre 6 est consacré à plusieurs méthodes de régression intégrant l’espace : modèles d’économétrie spatiale, modèles généralisés additifs (GAM) avec une spline bivariée sur les coordonnées géographiques, régressions géographiquement pondérées. Dans le ?sec-chap08, nous décrivons des méthodes permettant de regrouper des entités spatiales d’une région en plusieurs classes en fonction de leurs caractéristiques évaluées à partir de plusieurs variables. Nous distinguons deux types de méthodes de classification non supervisée spatiale : les méthodes de classification non supervisée avec contrainte spatiale visant à regrouper des entités spatiales en plusieurs régions avec une absence de mitage (algorithmes AZP, SKATER, REDCAP, etc.); les méthodes de classification non supervisée avec une dimension spatiale (méthode ClustGeo et classification floue c-moyennes spatiale)."
  },
  {
    "objectID": "index.html#sect006",
    "href": "index.html#sect006",
    "title": "Régressions spatiales : un grand bol d’R",
    "section": "Remerciements",
    "text": "Remerciements\nDe nombreuses personnes ont contribué à l’élaboration de ce manuel.\nCe projet a bénéficié du soutien pédagogique et financier de la fabriqueREL (ressources éducatives libres). Les différentes rencontres avec le comité de suivi nous ont permis de comprendre l’univers des ressources éducatives libres (REL) et notamment leurs fameux 5R (Retenir — Réutiliser — Réviser — Remixer — Redistribuer), de mieux définir le besoin pédagogique visé par ce manuel, d’identifier des ressources pédagogiques et des outils pertinents pour son élaboration. Ainsi, nous remercions chaleureusement les membres de la fabriqueREL pour leur soutien inconditionnel :\n\nMyriam Beaudet, bibliothécaire à l’Université de Sherbrooke.\nMarianne Dubé, coordonnatrice de la fabriqueREL, Université de Sherbrooke.\nSerge Piché, conseiller pédagogique, Université de Sherbrooke.\nClaude Potvin, conseiller en formation, Service de soutien à l’enseignement, Université Laval.\n\nNous remercions chaleureusement les personnes étudiantes du cours GMQ405 - Modélisation et analyse spatiale du Baccalauréat en géomatique appliquée à l’environnement et du Microprogramme de 1er cycle en géomatique appliquée du Département de géomatique appliquée de l’Université de Sherbrooke de la session d’été 2023 : Hermann B. Beaudin, Jérémie Durand, Marie-Hélène Gadbois Del Carpio, David Lapointe, Marc-Antoine Lecours-Toutloff, Rosemarie Légaré, Frédéric Malo, Anthony Mandeville, Gurwen Meret, Sarah Pion, Anne-Sophie Roy, William Scrive, Aldin Evrad Tampe et Kévin Therrien. Vos suggestions et commentaires nous ont permis d’améliorer grandement la version préliminaire de ce manuel qui a été utilisée dans le cadre de ce cours.\nNous remercions aussi les membres du comité de révision pour leurs commentaires et suggestions très constructifs. Ce comité est composé de quatre personnes étudiantes du Département de géomatique appliquée de l’Université de Sherbrooke :\n\nGaël Machemin et Loek Pascaud, étudiants à la maîtrise en géomatique appliquée et télédétection (type recherche).\nRosemarie Légaré, étudiante au baccalauréat en géomatique appliquée à l’environnement.\n\nMarie-Hélène Gadbois Del Carpio, étudiante de troisième année au baccalauréat en géomatique appliquée à l’environnement a participé activement à la mise en page du manuel; elle est désormais une grande spécialiste des feuilles de style en cascade (CSS) et de Quarto.\nAussi, les discussions enrichissantes avec Geneviève Crevier et Amélie Fréchette ont largement contribué à définir et à bonifier la table des matières.\nFinalement, nous remercions Denise Latreille, réviseure linguistique et chargée de cours à l’Université Sherbrooke, pour la révision du manuel."
  },
  {
    "objectID": "00-auteurs.html",
    "href": "00-auteurs.html",
    "title": "À propos des auteurs",
    "section": "",
    "text": "Philippe Apparicio est professeur titulaire au Département de géomatique appliquée de l’Université de Sherbrooke. Il y enseigne aux programmes de 1er et 2e cycles de géomatique les cours Transport et mobilité durable, Modélisation et analyse spatiale et Géomatique appliquée à la gestion urbaine. Géographe de formation, ses intérêts de recherche incluent la justice et l’équité environnementale, la mobilité durable, les pollutions atmosphérique et sonore, et le vélo en ville. Il a publié une centaine d’articles scientifiques dans différents domaines des études urbaines et de la géographie mobilisant la géomatique et l’analyse spatiale.\nJean Dubé est professeur titulaire à l’École Supérieure d’aménagement du territoire et de développement régional (ÉSAD) de l’Université Laval. Économiste de formation, ses intérêts de recherche portent notamment sur l’évaluation d’impact des politiques publiques liées à l’aménagement et au développement. Ses recherches portent sur la mesure des externalités urbaines par le marché immobilier, les décisions de localisation des entreprises et des ménages et les déterminants de la croissance urbaine et régionale. Il est aussi rédacteur de la Revue canadienne des sciences régionales (RCSR).\nJérémy Gelb a obtenu un doctorat en études urbaines à l’INRS en 2022 (L’exposition des cyclistes aux pollutions atmosphérique et sonore en milieu urbain : comparaison empirique de plusieurs villes à travers le monde), sous la supervision de Philippe Apparicio. Il utilise quotidiennement des systèmes d’information géographique (SIG) et des méthodes d’analyses spatiales. Il est tombé dans la marmite de l’open source avec le triptyque QGIS, R et Python au début de sa maîtrise. Il a développé deux packages : geocmeans et spNetwork, permettant respectivement d’effectuer des analyses de classification floue non supervisée pondérée spatialement et des estimations de densité par kernel sur réseau. Il travaille actuellement comme conseiller en science des données à l’Autorité régionale de transport métropolitain qui gère la planification du transport collectif dans la région de Montréal. Ces travaux portent sur la qualité des milieux urbains, l’accessibilité spatiale, le transport, l’équité environnementale, les SIG et l’analyse spatiale.\nJoan Carles Martori est professeur d’économie appliquée au département d’économie et de commerce de l’Université de Vic - Université centrale de la Catalogne (Barcelone, Espagne). Il enseigne les statistiques appliquées et l’économétrie dans des cours de premier et de deuxième cycle. Il est le chercheur principal du groupe Data Analysis and Modelling. Économiste de formation, ses recherches portent sur la ségrégation résidentielle, les inégalités et l’équité environnementale à l’aide des statistiques spatiales et de techniques économétriques. Il a contribué au développement du package R AQuadtree sur la confidentialité des données spatiales ponctuelles. En tant que statisticien appliqué, il collabore avec d’autres disciplines telles que l’éducation et la santé."
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-011",
    "href": "01-NotionsDeBase.html#sec-011",
    "title": "1  Notions de base",
    "section": "1.1 Description des jeux de données utilisés dans le manuel",
    "text": "1.1 Description des jeux de données utilisés dans le manuel"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-012",
    "href": "01-NotionsDeBase.html#sec-012",
    "title": "1  Notions de base",
    "section": "1.2 Conceptualisation de l’espace : matrices des pondérations spatiales",
    "text": "1.2 Conceptualisation de l’espace : matrices des pondérations spatiales\n\n1.2.1 Matrices de contiguïté\n\n\n1.2.2 Matrices de proximité\n\n\n1.2.3 Standardisation des matrices de pondération spatiale en ligne\n\n\n1.2.4 Mise en œuvre dans R"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-013",
    "href": "01-NotionsDeBase.html#sec-013",
    "title": "1  Notions de base",
    "section": "1.3 Notion de variable spatialement décalée",
    "text": "1.3 Notion de variable spatialement décalée"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-014",
    "href": "01-NotionsDeBase.html#sec-014",
    "title": "1  Notions de base",
    "section": "1.4 Notion d’autocorrélation spatiale",
    "text": "1.4 Notion d’autocorrélation spatiale\n\n1.4.1 Autocorrélation spatiale globale\n\n1.4.1.1 Statistique du I de Moran\n\n\n1.4.1.2 Statistiques de comptage de jointure\n\n\n\n1.4.2 Autocorrélation spatiale locale\n\n1.4.2.1 Statistiques locales de Getis et Ord\n\n\n1.4.2.2 Typologie basée sur le diagramme de Moran\n\n\n1.4.2.3 Version locale des statistiques de comptage de jointure"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-015",
    "href": "01-NotionsDeBase.html#sec-015",
    "title": "1  Notions de base",
    "section": "1.5 Retour sur la régression linéaire multiple",
    "text": "1.5 Retour sur la régression linéaire multiple"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-016",
    "href": "01-NotionsDeBase.html#sec-016",
    "title": "1  Notions de base",
    "section": "1.6 Notion de dépendance spatiale et d’hétérogénéité spatiale et de non-stationnarité spatiale",
    "text": "1.6 Notion de dépendance spatiale et d’hétérogénéité spatiale et de non-stationnarité spatiale"
  },
  {
    "objectID": "01-NotionsDeBase.html#sec-017",
    "href": "01-NotionsDeBase.html#sec-017",
    "title": "1  Notions de base",
    "section": "1.7 Pourquoi recourir à des régressions spatiales?",
    "text": "1.7 Pourquoi recourir à des régressions spatiales?\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nApparicio, Philippe et Jérémy Gelb. 2022. Méthodes quantitatives en sciences sociales : un grand bol d’R. FabriqueREL, Licence CC BY-SA. https://serieboldr.github.io/MethodesQuantitatives/."
  },
  {
    "objectID": "02-ModelesEconometrieSpatiale.html#sec-021",
    "href": "02-ModelesEconometrieSpatiale.html#sec-021",
    "title": "2  Modèles d’économétrie spatiale",
    "section": "\n2.1 Pourquoi recourir à des modèles économétriques spatiaux?",
    "text": "2.1 Pourquoi recourir à des modèles économétriques spatiaux?\n\n\n\n\n\nRégression linéaire multiple et modèles économétriques spatiaux\n\n\nDans cette section, nous décrivons uniquement les modèles économétriques spatiaux dont la variable dépendante est continue. Sommairement, ces modèles sont des extensions de la régression linéaire multiple dans laquelle est intégrée l’autocorrélation spatiale. Avant de lire cette section, il faut donc bien maîtriser la régression linéaire multiple. Si ce n’est pas le cas, nous vous invitons vivement à lire le chapitre suivant (Apparicio et Gelb 2022).\nCes deux dernières décennies, plusieurs ouvrages traitant des modèles économétriques spatiaux ont été publiés, surtout en anglais (LeSage et Pace 2008; Anselin et Rey 2014; Bivand et al. 2008). Ils méritent grandement d’être consultés, tout comme l’excellent livre en français de Jean Dubé et Diègo Legros (2014).\n\n\nDans un modèle, les résidus (\\(\\epsilon\\)) sont la différence entre les valeurs observées (\\(y_i\\)) et les valeurs prédites par le modèle (\\(\\widehat{y_i}\\)). Une des hypothèses de la régression linéaire multiple est que les observations doivent être indépendantes les unes des autres (indépendance du terme d’erreur). Le non-respect de cette hypothèse produit des résultats biaisés, notamment pour les coefficients de régression.\nLorsque les observations sont des entités spatiales (polygones, points par exemple), si les résidus du modèle sont autocorrélés spatialement, il y a un problème de dépendance spatiale du modèle. Autrement dit, les observations ne sont pas spatialement indépendantes les unes des autres. Pour vérifier la dépendance spatiale d’un modèle, il suffit de calculer le I de Moran sur les résidus du modèle, comme décrit au chapitre 2 (?sec-023).\nAutrement dit, un modèle de régression construit avec des données spatiales ne devrait pas avoir des résidus spatialement autocorrélés. Or, les modèles économétriques spatiaux permettent justement d’intégrer l’autocorrélation spatiale de différentes manières afin de s’assurer que l’hypothèse de l’indépendance du terme d’erreur est respectée.\n\n2.1.1 Les différents modèles spatiaux autorégressifs\nSelon Jean Dubé et Diègo Legros, « cinq raisons peuvent motiver le choix d’un modèle autorégressif : la présence d’externalités, les effets d’entraînement, l’omission de variables importantes, la présence d’hétérogénéité spatiale des comportements, les effets mixtes » (2014, 120). Les effets mixtes peuvent être la combinaison d’externalités avec des effets d’entraînement ou encore d’externalités avec l’omission d’une ou de plusieurs variables importantes spatialement structurées.\n\n2.1.1.1 Modèle SLX : autocorrélation spatiale sur les variables indépendantes\nDans un modèle SLX, l’autocorrélation spatiale est intégrée au niveau des variables indépendantes. Autrement dit, les variables indépendantes spatialement décalées (\\(WX\\)) sont introduites aussi dans le modèle. Par conséquent, la valeur de chaque unité spatiale du modèle est ainsi expliquée à la fois par ses propres caractéristiques et celles dans le voisinage ou à proximité en fonction de la matrice de pondération spatiale (\\(W\\)).\n\n\n\n\n\nRappel sur les variables spatialement décalées\n\n\nDans le chapitre 2 sur l’autocorrélation spatiale, nous avons vu comment calculer une variable spatialement décalée avec une matrice de pondération spatiale (?fig-Chap02FigureVariableSpatialementDecalee). À titre de rappel, lorsque cette dernière est standardisée en ligne, elle correspond à la valeur moyenne dans le voisinage.\n\n\nL’idée est alors d’introduire des externalités puisque les caractéristiques des entités spatiales proches ou voisines peuvent avoir un effet sur la variable dépendante (Dubé et Legros 2014). L’équation du modèle SLX, qui est estimée selon la méthode des moindres carrés ordinaires (comme la régression linéaire multiple), s’écrit alors :\n\\[\ny = X\\beta + WX\\theta + \\epsilon\n\\tag{2.1}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables indépendantes.\n\n\\(W\\), la matrice de pondération spatiale.\n\n\\(WX\\), les variables indépendantes spatiales décalées.\n\n\\(\\theta\\), les coefficients des variables indépendantes spatiales décalées.\n\n\\(\\epsilon\\), les résidus.\n\nConstruction du modèle SLX dans R\nLe modèle SLX est construit avec la fonction lmSLX du package spatialreg (Bivand, Millo et Piras 2021). Remarquez, dans le code ci-dessous, le paramètre listw=W.Rook qui est utilisé pour spécifier la matrice de pondération spatiale.\n\n## Chargemement des packages\nlibrary(sf)\nlibrary(tmap)\nlibrary(spdep)\n\nWarning: le package 'spdep' a été compilé avec la version R 4.4.1\n\n\nWarning: le package 'spData' a été compilé avec la version R 4.4.1\n\nlibrary(spatialreg)\n## Matrice de contiguïté selon le partage d'un segment (Rook)\nRook &lt;- poly2nb(LyonIris, queen=FALSE)\nW.Rook &lt;- nb2listw(Rook, zero.policy=TRUE, style = \"W\")\n## Construction du modèle MCO\nModele.MCO &lt;- lm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                 data = LyonIris)\n## Construction du modèle\nModele.SLX &lt;- lmSLX(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                   listw=W.Rook,     # matrice de pondération spatiale\n                   data = LyonIris)  # dataframe\n## Résultats du modèle\nsummary(Modele.SLX)\n\n\nCall:\nlm(formula = formula(paste(\"y ~ \", paste(colnames(x)[-1], collapse = \"+\"))), \n    data = as.data.frame(x), weights = weights)\n\nCoefficients:\n                Estimate    Std. Error  t value     Pr(&gt;|t|)  \n(Intercept)      5.068e+01   4.188e+00   1.210e+01   1.040e-29\nPct0_14         -2.040e-01   6.268e-02  -3.255e+00   1.211e-03\nPct_65          -3.771e-02   5.361e-02  -7.033e-01   4.822e-01\nPct_Img          1.041e-01   4.849e-02   2.146e+00   3.235e-02\nPct_brevet      -7.363e-02   3.550e-02  -2.074e+00   3.857e-02\nNivVieMed       -1.844e-01   1.106e-01  -1.667e+00   9.617e-02\nlag.Pct0_14     -7.759e-01   1.030e-01  -7.537e+00   2.315e-13\nlag.Pct_65      -6.454e-02   9.115e-02  -7.081e-01   4.792e-01\nlag.Pct_Img      6.465e-01   8.593e-02   7.524e+00   2.526e-13\nlag.Pct_brevet  -3.013e-01   6.157e-02  -4.893e+00   1.344e-06\nlag.NivVieMed   -1.805e-02   1.750e-01  -1.031e-01   9.179e-01\n\n\n\n\n\n\n\nEffets directs, indirects et totaux\n\n\nLa formulation d’un modèle SLX implique deux types d’effets pour les variables indépendantes (\\(X\\)) :\n\nles effets directs, soit ceux des caractéristiques des entités spatiales. Ils correspondent aux coefficients \\(\\beta\\) des variables indépendantes (\\(X\\)). Autrement dit, pour une observation \\(i\\), à chaque augmentation d’une unité d’une caractéristique \\(X\\), la valeur de \\(y_i\\) va varier (augmenter ou diminuer) en fonction du coefficient \\(\\beta\\).\nles effets indirects, soit ceux des caractéristiques des entités spatiales voisines ou proches définies selon la matrice de pondération spatiale. Ils correspondent aux coefficients \\(\\theta\\) des variables indépendantes spatialement décalées (\\(WX\\)). Autrement dit, les valeurs de \\(WX\\) des entités spatiales proches ou voisines \\(j\\) de \\(i\\) vont aussi être amenées à varier, impactant alors les valeurs \\(y_j\\) selon les coefficients \\(\\theta\\).\n\nPrenons l’exemple d’un modèle visant à prédire le prix de vente des maisons dans une ville en fonction de leurs caractéristiques des maisons, dont la superficie du jardin. Il est probable que plus la superficie du jardin de la maison \\(i\\) augmente, plus le prix de vente augmente également (effet direct, coefficient \\(\\beta\\)). Cette augmentation de la taille du jardin aura aussi un impact sur le prix des maisons voisines puisque leur prix est dépendant de la taille des jardins des maisons voisines. Ainsi, chaque maison \\(j\\), voisine de \\(i\\) verra son prix augmenter à cause de l’augmentation de la taille du jardin de la maison \\(i\\) (effet indirect).\nPour capturer l’impact total sur le prix des maisons d’une augmentation de la superficie du jardin de la maison \\(i\\), il suffit de sommer son effet direct (augmentation du prix de la maison \\(i\\)) et son effet indirect (augmentation du prix des maisons \\(j\\)) pour obtenir son effet total.\nLe code suivant permet de calculer ces effets directs et indirects.\n\n## Effets directs, indirects et totaux (uniquement les coefficients)\nimpacts(Modele.SLX)\n\nImpact measures (SlX, glht):\n                Direct    Indirect      Total\nPct0_14    -0.20403803 -0.77590830 -0.9799463\nPct_65     -0.03770918 -0.06453809 -0.1022473\nPct_Img     0.10406359  0.64653923  0.7506028\nPct_brevet -0.07363272 -0.30128171 -0.3749144\nNivVieMed  -0.18440960 -0.01804718 -0.2024568\n\n## Effets directs, indirects et totaux (coefficients, valeurs de z et de p)\nsummary(impacts(Modele.SLX))\n\nImpact measures (SlX, glht, n-k):\n                Direct    Indirect      Total\nPct0_14    -0.20403803 -0.77590830 -0.9799463\nPct_65     -0.03770918 -0.06453809 -0.1022473\nPct_Img     0.10406359  0.64653923  0.7506028\nPct_brevet -0.07363272 -0.30128171 -0.3749144\nNivVieMed  -0.18440960 -0.01804718 -0.2024568\n========================================================\nStandard errors:\n               Direct   Indirect      Total\nPct0_14    0.06268202 0.10295210 0.10045332\nPct_65     0.05361420 0.09114695 0.08556272\nPct_Img    0.04849085 0.08593145 0.08060028\nPct_brevet 0.03549819 0.06157121 0.05975821\nNivVieMed  0.11063207 0.17499339 0.14911021\n========================================================\nZ-values:\n               Direct   Indirect     Total\nPct0_14    -3.2551283 -7.5365951 -9.755241\nPct_65     -0.7033432 -0.7080664 -1.194998\nPct_Img     2.1460460  7.5238953  9.312658\nPct_brevet -2.0742665 -4.8932234 -6.273857\nNivVieMed  -1.6668729 -0.1031306 -1.357766\n\np-values:\n           Direct    Indirect   Total     \nPct0_14    0.0011334 4.8184e-14 &lt; 2.22e-16\nPct_65     0.4818419 0.47890    0.23209   \nPct_Img    0.0318693 5.3069e-14 &lt; 2.22e-16\nPct_brevet 0.0380546 9.9198e-07 3.5221e-10\nNivVieMed  0.0955397 0.91786    0.17454   \n\n\nÀ la lecture des valeurs de p, nous constatons que seule la variable Pct0_14 a un impact direct et indirect significatif au seuil 0,01. L’augmentation d’un point de pourcentage de la population de moins de 15 ans est associé localement à une réduction de 0,20 de la concentration annuelle du dioxyde d’azote. Chez les entités voisines, cette réduction est de 0,78 et l’effet total est donc une réduction de 0,98.\n\n\nDépendance spatiale du modèle SLX?\nCe modèle a-t-il corrigé le problème de dépendance spatiale du modèle de régression linéaire classique? Avec une valeur du I de Moran de 0,605 (p &lt; 0,001), les résidus sont toujours fortement autocorrélés spatialement (figure 2.2).\n\nlm.morantest(Modele.SLX, W.Rook, alternative=\"two.sided\")\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = formula(paste(\"y ~ \", paste(colnames(x)[-1],\ncollapse = \"+\"))), data = as.data.frame(x), weights = weights)\nweights: W.Rook\n\nMoran I statistic standard deviate = 21.951, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\nsample estimates:\nObserved Moran I      Expectation         Variance \n    0.6046602748    -0.0072844321     0.0007771643 \n\nLyonIris$SLX.Residus &lt;- residuals(Modele.SLX)\ntm_shape(LyonIris)+\n  tm_fill(col=\"SLX.Residus\", n = 5, style = \"quantile\", \n          legend.format = list(text.separator = \"à\"),\n          palette = \"-RdBu\", title = \"Résidus\") +\n  tm_layout(frame=FALSE) + \n  tm_scale_bar(breaks = c(0,5))\n\n\n\nFigure 2.2: Cartographie des résidus du modèle SLX\n\n\n\n\n2.1.1.2 Modèle SAR : autocorrélation spatiale sur la variable dépendante\nDans le modèle SAR (aussi appelé SAR-LAG), l’autocorrélation spatiale est intégrée au niveau de la variable dépendante (\\(Wy\\)), qui est ainsi spatialement décalée. L’idée générale est que la valeur de la variable dépendante pour une observation (\\(y_i\\)) peut être influencée par les valeurs de \\(y\\) des observations voisines et proches. L’exemple le plus classique est le prix de vente des maisons : il est influencé à la fois par les caractéristiques intrinsèques de la maison (\\(X\\), par exemple, la superficie habitable, le nombre de chambres à coucher, de salles de bains, etc.) et par le prix de vente des maisons voisines (\\(Wy\\)). Jean Dubé et Diègo Legros (2014) qualifient ce phénomène « d’effets d’entraînement ou d’effets de débordement (spillover effects) » (2014, 123). L’équation du modèle SAR s’écrit alors :\n\\[\ny = Wy\\rho + X\\beta + \\epsilon\n\\tag{2.2}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(W\\), la matrice de pondération spatiale.\n\n\\(Wy\\), la variable dépendante spatialement décalée.\n\n\\(\\rho\\) (prononcez rho), le coefficient de la variable dépendante spatialement décalée. Il varie de -1 à 1.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables indépendantes.\n\n\\(\\epsilon\\), les résidus.\n\nConstruction du modèle SAR dans R\nLe modèle SAR est construit avec la fonction lagsarlm du package spatialreg.\n\n## Construction du modèle\nModele.SAR &lt;- lagsarlm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                              listw=W.Rook,    # matrice de pondération spatiale\n                              data = LyonIris, # dataframe\n                              type = 'lag')    # Modèle lag par défaut\n## Résultats du modèle\nsummary(Modele.SAR, Nagelkerke=TRUE)\n\n\nCall:lagsarlm(formula = NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + \n    NivVieMed, data = LyonIris, listw = W.Rook, type = \"lag\")\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12.86859  -1.88111  -0.49760   0.94464  18.21351 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n             Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  7.838906   1.646232  4.7617 1.919e-06\nPct0_14     -0.098708   0.030554 -3.2306  0.001235\nPct_65      -0.034543   0.026957 -1.2814  0.200044\nPct_Img      0.030241   0.024491  1.2348  0.216917\nPct_brevet  -0.019234   0.017855 -1.0772  0.281384\nNivVieMed   -0.098413   0.048985 -2.0090  0.044534\n\nRho: 0.87939, LR test value: 620.31, p-value: &lt; 2.22e-16\nAsymptotic standard error: 0.01942\n    z-value: 45.283, p-value: &lt; 2.22e-16\nWald statistic: 2050.5, p-value: &lt; 2.22e-16\n\nLog likelihood: -1366.157 for lag model\nML residual variance (sigma squared): 10.181, (sigma: 3.1908)\nNagelkerke pseudo-R-squared: 0.78962 \nNumber of observations: 506 \nNumber of parameters estimated: 8 \nAIC: 2748.3, (AIC for lm: 3366.6)\nLM test for residual autocorrelation\ntest value: 0.6198, p-value: 0.43112\n\n\nDans les résultats ci-dessus, la valeur de rho est de 0,88 (LR = 620, p &lt; 0,001), traduisant un très fort effet d’entraînement. Autrement dit, lorsqu’en moyenne la concentration de dioxyde d’azote augmente dans les IRIS voisines (\\(Wy\\)), elle augmente aussi fortement chaque IRIS (\\(y\\)).\n\n\n\n\n\nEffets directs, indirects et totaux\n\n\nTout comme le modèle SLX vu précédemment, la formulation du modèle SAR-LAG implique des effets particuliers. Reprenons l’exemple d’un modèle prédisant le prix de vente des maisons avec cette fois-ci un modèle de type SAR-LAG :\n\nL’augmentation de la superficie du jardin de la maison \\(i\\) va faire augmenter le prix de la maison \\(i\\) (\\(y_i\\)).\nCette augmentation de prix de la maison \\(i\\) aura un impact sur les voisins de \\(i\\), soit les maisons \\(j\\), car leur prix dépend du prix de la maison \\(i\\) au travers du terme \\(Wy\\rho\\) du modèle. Par exemple, si \\(\\rho\\) vaut 0,8, alors 80% de l’augmentation du prix de \\(i\\) va se répercuter sur le prix des maisons \\(j\\).\nDe même, les voisines des maisons \\(j\\), les maisons \\(k\\) vont aussi être impactées par le changement de prix des maisons \\(j\\) et ainsi de suite de voisins en voisins.\nAu final, la maison \\(i\\) verra son prix augmenter encore plus, car le prix de ses voisines aura augmenté par effet de rétroaction.\n\nCe processus de propagation est appelé l’effet d’entraînement ou de débordement (spillover) en économétrie.\nL’effet original de l’augmentation de la taille du jardin sur la maison \\(i\\), combiné à l’augmentation par rétroaction, est appelé l’effet direct. L’effet cumulé de l’augmentation de la taille du jardin sur toutes les autres maisons (\\(\\neq i\\)) est appelé l’effet indirect. La somme des effets indirects et des directs est appelée effets totaux.\nÀ nouveau, il est possible d’utiliser la fonction impacts pour calculer ces effets directs et indirects.\n\n## Effets directs, indirects et totaux (uniquement les coefficients)\nimpacts(Modele.SAR, listw = W.Rook, R = 999)\n\nImpact measures (lag, exact):\n                Direct   Indirect      Total\nPct0_14    -0.13878038 -0.6796248 -0.8184052\nPct_65     -0.04856624 -0.2378349 -0.2864012\nPct_Img     0.04251743  0.2082131  0.2507306\nPct_brevet -0.02704205 -0.1324283 -0.1594703\nNivVieMed  -0.13836534 -0.6775923 -0.8159576\n\n## Effets directs, indirects et totaux (coefficients, valeurs de z et de p)\nsummary(impacts(Modele.SAR, listw = W.Rook, R = 999), zstats = TRUE, short = TRUE)\n\nImpact measures (lag, exact):\n                Direct   Indirect      Total\nPct0_14    -0.13878038 -0.6796248 -0.8184052\nPct_65     -0.04856624 -0.2378349 -0.2864012\nPct_Img     0.04251743  0.2082131  0.2507306\nPct_brevet -0.02704205 -0.1324283 -0.1594703\nNivVieMed  -0.13836534 -0.6775923 -0.8159576\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n               Direct  Indirect     Total\nPct0_14    0.04232402 0.2387631 0.2764106\nPct_65     0.03765749 0.1976269 0.2340098\nPct_Img    0.03495773 0.1788812 0.2129360\nPct_brevet 0.02514896 0.1294400 0.1540050\nNivVieMed  0.06983355 0.3672732 0.4336593\n\nSimulated z-values:\n              Direct  Indirect     Total\nPct0_14    -3.268727 -2.888134 -2.995273\nPct_65     -1.370386 -1.299862 -1.318291\nPct_Img     1.186492  1.149464  1.160417\nPct_brevet -1.060366 -1.019037 -1.029650\nNivVieMed  -1.975716 -1.869384 -1.901368\n\nSimulated p-values:\n           Direct    Indirect  Total   \nPct0_14    0.0010803 0.0038753 0.002742\nPct_65     0.1705665 0.1936483 0.187406\nPct_Img    0.2354279 0.2503646 0.245879\nPct_brevet 0.2889783 0.3081853 0.303175\nNivVieMed  0.0481869 0.0615693 0.057254\n\n\nL’interprétation des effets directs se rapproche de celle des coefficients classiques. Ainsi, selon ce modèle, l’augmentation du niveau de vie médian de 1000 € dans un IRIS est associée avec une diminution moyenne de la concentration de dioxyde d’azote de 0,14 dans cet IRIS. L’effet total est de -0.82, indiquant qu’en moyenne, l’augmentation de 1000 € du niveau de vie médian dans un IRIS est associée avec une diminution moyenne de 0,82 de la concentration de dioxyde d’azote dans l’ensemble des IRIS. Au final, l’effet indirect est simplement la différence entre l’effet total et l’effet direct. Nous pouvons constater ici que les effets indirects sont plus importants que les effets directs.\n\n\nDépendance spatiale du modèle SAR?\nCe modèle a-t-il corrigé le problème de dépendance spatiale du modèle de régression linéaire classique? Avec une valeur du I de Moran de -0,014 (p = 0,654), les résidus ne sont plus spatialement autocorrélés (figure 2.3).\n\n## Autocorrélation spatiale des résidus\nmoran.mc(resid(Modele.SAR), W.Rook, nsim=999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  resid(Modele.SAR) \nweights: W.Rook  \nnumber of simulations + 1: 1000 \n\nstatistic = -0.014281, observed rank = 328, p-value = 0.672\nalternative hypothesis: greater\n\n## Cartographie des résidus\nLyonIris$SAR.Residus &lt;- resid(Modele.SAR)\ntm_shape(LyonIris)+\n  tm_fill(col=\"SAR.Residus\", n = 5, style = \"quantile\", \n          legend.format = list(text.separator = \"à\"),\n          palette = \"-RdBu\", title = \"Résidus\") +\n  tm_layout(frame=FALSE) + \n  tm_scale_bar(breaks = c(0,5))\n\n\n\nFigure 2.3: Cartographie des résidus du modèle SAR\n\n\n\n\n2.1.1.3 Modèle SEM : autocorrélation spatiale sur le terme d’erreur\nDans le modèle SEM (Spatial Error Model, appelé aussi SAR-ERROR), l’intégration de l’autocorrélation spatiale est réalisée sur le terme d’erreur, ce qui pourrait se justifier par l’omission d’une variable dépendante spatialement structurée (Dubé et Legros 2014, 126). L’équation du modèle SEM s’écrit :\n\\[\ny = X\\beta + u \\textrm{, } u = \\lambda Wu + \\epsilon\n\\tag{2.3}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(W\\), la matrice de pondération spatiale.\n\n\\(\\lambda\\) (prononcez lambda), le coefficient sur le terme d’erreur spatialement décalé. Il varie de -1 à 1.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables indépendantes.\n\n\\(\\epsilon\\), les résidus.\n\nConstruction du modèle SAR dans R\nLe modèle SEM est construit avec la fonction errorsarlm du package spatialreg.\n\n## Construction du modèle\nModele.SEM &lt;- errorsarlm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                         listw=W.Rook,    # matrice de pondération spatiale\n                         data = LyonIris) # dataframe\n## Résultats du modèle\nsummary(Modele.SEM, Nagelkerke=TRUE)\n\n\nCall:errorsarlm(formula = NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + \n    NivVieMed, data = LyonIris, listw = W.Rook)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12.86150  -1.83161  -0.44106   0.91029  17.94924 \n\nType: error \nCoefficients: (asymptotic standard errors) \n             Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept) 30.544576   2.358173 12.9526  &lt; 2e-16\nPct0_14     -0.035019   0.033393 -1.0487  0.29431\nPct_65      -0.026039   0.028970 -0.8988  0.36874\nPct_Img     -0.016770   0.026176 -0.6407  0.52175\nPct_brevet   0.023708   0.019074  1.2430  0.21388\nNivVieMed   -0.146309   0.060273 -2.4274  0.01521\n\nLambda: 0.91138, LR test value: 613.15, p-value: &lt; 2.22e-16\nAsymptotic standard error: 0.01651\n    z-value: 55.201, p-value: &lt; 2.22e-16\nWald statistic: 3047.2, p-value: &lt; 2.22e-16\n\nLog likelihood: -1369.737 for error model\nML residual variance (sigma squared): 9.9971, (sigma: 3.1618)\nNagelkerke pseudo-R-squared: 0.78662 \nNumber of observations: 506 \nNumber of parameters estimated: 8 \nAIC: 2755.5, (AIC for lm: 3366.6)\n\n\nDans les résultats ci-dessus, la valeur de lambda est de 0,91 (LR = 613, p &lt; 0,001), traduisant une très forte autocorrélation spatiale sur le terme d’erreur.\nDépendance spatiale du modèle SEM?\nCe modèle a-t-il corrigé le problème de dépendance spatiale du modèle de régression linéaire classique? Avec une valeur du I de Moran de -0,013 (p = 0,614), les résidus ne sont plus spatialement autocorrélés.\n\n## Autocorrélation spatiale des résidus\nmoran.mc(resid(Modele.SEM), W.Rook, nsim=999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  resid(Modele.SEM) \nweights: W.Rook  \nnumber of simulations + 1: 1000 \n\nstatistic = -0.011827, observed rank = 374, p-value = 0.626\nalternative hypothesis: greater\n\n\n\n2.1.1.4 Modèle SDM : autocorrélation spatiale sur la variable dépendante et les variables indépendantes\nLe modèle SDM (Spatial Durbin Model) est un modèle mixte qui intègre à la fois l’autocorrélation spatiale sur la variable dépendante (\\(Wy\\), effets d’entraînement ou de débordement) et sur les variables indépendantes (\\(WX\\), externalités). Il s’écrit alors :\n\\[\ny = Wy\\rho + X\\beta + WX\\theta + \\epsilon\n\\tag{2.4}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(W\\), la matrice de pondération spatiale.\n\n\\(Wy\\), la variable dépendante spatialement décalée.\n\n\\(\\rho\\), le coefficient de la variable dépendante spatialement décalée.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables indépendantes.\n\n\\(WX\\), les variables indépendantes spatiales décalées.\n\n\\(\\theta\\), les coefficients des variables indépendantes spatiales décalées.\n\n\\(\\epsilon\\), les résidus.\n\nConstruction du modèle SDM dans R\nLe modèle SDM est construit avec la fonction lagsarlm du package spatialreg. Notez que le paramètre type = \"mixed\" spécifie l’utilisation d’un modèle mixte.\n\n## Construction du modèle\nModele.DurbinSpatial &lt;- lagsarlm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                       listw = W.Rook,    # matrice de pondération spatiale\n                       data = LyonIris,   # dataframe\n                       type = \"mixed\")\n## Résultats du modèles\nsummary(Modele.DurbinSpatial, Nagelkerke=TRUE)\n\n\nCall:lagsarlm(formula = NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + \n    NivVieMed, data = LyonIris, listw = W.Rook, type = \"mixed\")\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12.60922  -1.77753  -0.43909   0.99252  18.15526 \n\nType: mixed \nCoefficients: (asymptotic standard errors) \n                 Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)     8.1130457  2.5671301  3.1604 0.001576\nPct0_14        -0.0574046  0.0344908 -1.6643 0.096043\nPct_65         -0.0238715  0.0293647 -0.8129 0.416256\nPct_Img         0.0048364  0.0266560  0.1814 0.856025\nPct_brevet      0.0112746  0.0195259  0.5774 0.563656\nNivVieMed      -0.1463876  0.0605853 -2.4162 0.015682\nlag.Pct0_14    -0.1242574  0.0581170 -2.1381 0.032512\nlag.Pct_65      0.0255480  0.0499646  0.5113 0.609125\nlag.Pct_Img     0.1559952  0.0482138  3.2355 0.001214\nlag.Pct_brevet -0.0883930  0.0342496 -2.5809 0.009856\nlag.NivVieMed   0.1032469  0.0960201  1.0753 0.282257\n\nRho: 0.84127, LR test value: 492.38, p-value: &lt; 2.22e-16\nAsymptotic standard error: 0.023363\n    z-value: 36.009, p-value: &lt; 2.22e-16\nWald statistic: 1296.7, p-value: &lt; 2.22e-16\n\nLog likelihood: -1353.106 for mixed model\nML residual variance (sigma squared): 9.9845, (sigma: 3.1598)\nNagelkerke pseudo-R-squared: 0.8002 \nNumber of observations: 506 \nNumber of parameters estimated: 13 \nAIC: 2732.2, (AIC for lm: 3222.6)\nLM test for residual autocorrelation\ntest value: 0.0748, p-value: 0.78447\n\n\nEffets directs, indirects et totaux\n\n# Effets directs, indirects et totaux (uniquement les coefficients)\nimpacts(Modele.DurbinSpatial, listw = W.Rook, R = 999)\n\nImpact measures (mixed, exact):\n                Direct    Indirect       Total\nPct0_14    -0.12369039 -1.02079497 -1.14448536\nPct_65     -0.02177191  0.03233406  0.01056215\nPct_Img     0.06632543  0.94692639  1.01325182\nPct_brevet -0.01903815 -0.46681402 -0.48585217\nNivVieMed  -0.15403413 -0.11775603 -0.27179016\n\n# Effets directs, indirects et totaux (coefficients, valeurs de z et de p)\nsummary(impacts(Modele.DurbinSpatial, listw = W.Rook, R = 999), zstats = TRUE, short = TRUE)\n\nImpact measures (mixed, exact):\n                Direct    Indirect       Total\nPct0_14    -0.12369039 -1.02079497 -1.14448536\nPct_65     -0.02177191  0.03233406  0.01056215\nPct_Img     0.06632543  0.94692639  1.01325182\nPct_brevet -0.01903815 -0.46681402 -0.48585217\nNivVieMed  -0.15403413 -0.11775603 -0.27179016\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n               Direct  Indirect     Total\nPct0_14    0.04327488 0.3360273 0.3646389\nPct_65     0.03621012 0.2831102 0.3060171\nPct_Img    0.03249959 0.2686861 0.2889084\nPct_brevet 0.02422890 0.2010798 0.2164395\nNivVieMed  0.06647469 0.4919150 0.5248779\n\nSimulated z-values:\n               Direct   Indirect       Total\nPct0_14    -2.8905819 -3.0557742 -3.15905174\nPct_65     -0.6069750  0.1675100  0.08314945\nPct_Img     2.0322028  3.5630368  3.54224484\nPct_brevet -0.8120021 -2.3874270 -2.30890139\nNivVieMed  -2.3720987 -0.2804918 -0.56329790\n\nSimulated p-values:\n           Direct    Indirect   Total     \nPct0_14    0.0038453 0.00224480 0.00158283\nPct_65     0.5438675 0.86696876 0.93373270\nPct_Img    0.0421331 0.00036659 0.00039674\nPct_brevet 0.4167904 0.01696677 0.02094905\nNivVieMed  0.0176874 0.77910025 0.57323205\n\n\nDépendance spatiale du modèle SDM?\n\nmoran.mc(resid(Modele.DurbinSpatial), W.Rook, nsim=999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  resid(Modele.DurbinSpatial) \nweights: W.Rook  \nnumber of simulations + 1: 1000 \n\nstatistic = -0.0046127, observed rank = 474, p-value = 0.526\nalternative hypothesis: greater\n\n\n\n2.1.1.5 Modèle SDEM : autocorrélation spatiale sur les variables indépendantes et sur le terme d’erreur\nLe modèle SDEM (Spatial Durbin Error Model en anglais) est un autre modèle mixte qui intègre à la fois l’autocorrélation spatiale sur les valeurs indépendantes (\\(WX\\), externalités) et sur le terme d’erreur (\\(u = \\lambda Wu + \\epsilon\\)). Il s’écrit alors :\n\\[\ny = X\\beta + WX\\theta + u \\textrm{, } u = \\lambda Wu + \\epsilon\n\\tag{2.5}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(W\\), la matrice de pondération spatiale.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables indépendantes.\n\n\\(WX\\), les variables dépendantes spatiales décalées.\n\n\\(\\theta\\), les coefficients des variables indépendantes spatiales décalées.\n\n\\(\\lambda\\) (prononcez lambda), le coefficient sur le terme d’erreur spatialement décalé.\n\n\\(\\epsilon\\), les résidus.\n\nConstruction du modèle SDEM dans R\nLe modèle SDEM est construit avec la fonction errorsarlm du package spatialreg. Notez que le paramètre etype = \"mixed\" spécifie l’utilisation d’un modèle mixte.\n\n## Construction du modèle\nModele.DurbinErreur &lt;- errorsarlm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                                  listw=W.Rook,    # matrice de pondération spatiale\n                                  data = LyonIris, # dataframe\n                                  etype = 'emixed')\n## Résultats du modèle\nsummary(Modele.DurbinErreur, Nagelkerke=TRUE)\n\n\nCall:errorsarlm(formula = NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + \n    NivVieMed, data = LyonIris, listw = W.Rook, etype = \"emixed\")\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12.99324  -1.82407  -0.45644   1.06084  18.21108 \n\nType: error \nCoefficients: (asymptotic standard errors) \n                Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)    37.061010   6.501018  5.7008 1.192e-08\nPct0_14        -0.081998   0.041699 -1.9664   0.04925\nPct_65         -0.026329   0.034714 -0.7585   0.44817\nPct_Img         0.004656   0.031028  0.1501   0.88072\nPct_brevet      0.009785   0.023884  0.4097   0.68203\nNivVieMed      -0.167855   0.068005 -2.4683   0.01358\nlag.Pct0_14    -0.176747   0.102345 -1.7270   0.08417\nlag.Pct_65      0.010533   0.089183  0.1181   0.90599\nlag.Pct_Img     0.092785   0.079704  1.1641   0.24437\nlag.Pct_brevet -0.038048   0.056688 -0.6712   0.50211\nlag.NivVieMed  -0.102531   0.172405 -0.5947   0.55204\n\nLambda: 0.8976, LR test value: 464.09, p-value: &lt; 2.22e-16\nAsymptotic standard error: 0.018242\n    z-value: 49.204, p-value: &lt; 2.22e-16\nWald statistic: 2421, p-value: &lt; 2.22e-16\n\nLog likelihood: -1367.25 for error model\nML residual variance (sigma squared): 10.046, (sigma: 3.1696)\nNagelkerke pseudo-R-squared: 0.78871 \nNumber of observations: 506 \nNumber of parameters estimated: 13 \nAIC: 2760.5, (AIC for lm: 3222.6)\n\n\nEffets directs, indirects et totaux\n\n## Effets directs, indirects et totaux (uniquement les coefficients)\nimpacts(Modele.DurbinErreur, listw = W.Rook, R = 999)\n\nImpact measures (SDEM, glht):\n                 Direct    Indirect       Total\nPct0_14    -0.081997642 -0.17674683 -0.25874447\nPct_65     -0.026329370  0.01053248 -0.01579689\nPct_Img     0.004656039  0.09278511  0.09744115\nPct_brevet  0.009784961 -0.03804813 -0.02826317\nNivVieMed  -0.167855498 -0.10253070 -0.27038620\n\n## Effets directs, indirects et totaux (coefficients, valeurs de z et de p)\nsummary(impacts(Modele.DurbinErreur, listw = W.Rook, R = 999), zstats = TRUE, short = TRUE)\n\nImpact measures (SDEM, glht, n):\n                 Direct    Indirect       Total\nPct0_14    -0.081997642 -0.17674683 -0.25874447\nPct_65     -0.026329370  0.01053248 -0.01579689\nPct_Img     0.004656039  0.09278511  0.09744115\nPct_brevet  0.009784961 -0.03804813 -0.02826317\nNivVieMed  -0.167855498 -0.10253070 -0.27038620\n========================================================\nStandard errors:\n               Direct   Indirect      Total\nPct0_14    0.04169878 0.10234506 0.13146453\nPct_65     0.03471367 0.08918350 0.11192948\nPct_Img    0.03102807 0.07970364 0.09949722\nPct_brevet 0.02388387 0.05668833 0.07344175\nNivVieMed  0.06800483 0.17240549 0.21172909\n========================================================\nZ-values:\n               Direct   Indirect      Total\nPct0_14    -1.9664279 -1.7269698 -1.9681695\nPct_65     -0.7584727  0.1180989 -0.1411325\nPct_Img     0.1500589  1.1641264  0.9793354\nPct_brevet  0.4096890 -0.6711810 -0.3848379\nNivVieMed  -2.4682880 -0.5947067 -1.2770385\n\np-values:\n           Direct   Indirect Total   \nPct0_14    0.049249 0.084173 0.049049\nPct_65     0.448168 0.905989 0.887765\nPct_Img    0.880718 0.244373 0.327414\nPct_brevet 0.682034 0.502105 0.700358\nNivVieMed  0.013576 0.552040 0.201589\n\n\nDépendance spatiale du modèle SDEM?\nAvec une valeur du I de Moran de -0,010 (p = 0,619), les résidus du modèle SDEM ne sont pas spatialement autocorrélés.\n\nmoran.mc(resid(Modele.DurbinErreur), W.Rook, nsim=999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  resid(Modele.DurbinErreur) \nweights: W.Rook  \nnumber of simulations + 1: 1000 \n\nstatistic = -0.010362, observed rank = 400, p-value = 0.6\nalternative hypothesis: greater\n\n\n\n2.1.2 Quel modèle choisir?\n\n2.1.2.1 Tests du multiplicateur de Lagrange sur le modèle MCO\nL’utilisation des tests du multiplicateur de Lagrange (simple et robuste) a été largement popularisée par Anselin et al. (1996) pour vérifier si le recours à un modèle autorégressif est nécessaire, comparativement à un modèle de régression classique (MCO). Les tests sont calculés sur le modèle MCO avec la fonction lm.LMtests et une matrice de pondération spatiale. Ces tests permettent aussi de choisir entre les modèles SAR et SEM. La démarche suivante peut être utilisée pour choisir un modèle :\n\nSi toutes les valeurs des tests (simples et robustes) sont non significatives (p &gt; 0,05), alors le recours à un modèle autorégressif n’est pas nécessaire. Nous pouvons conserver le modèle de régression classique (MCO).\nSi les valeurs de LMlag ou RLMlag sont non significatives (p &gt; 0,05), alors le recours au modèle SAR n’est pas nécessaire.\nSi les valeurs de LMerr ou RLMerr sont non significatives (p &gt; 0,05), alors le recours au modèle SEM n’est pas nécessaire.\nSi les valeurs de RLMlag et RLMerr sont significatives (p &lt; 0,001), nous choisissons le modèle ayant la plus forte statistique.\n\nDans les résultats ci-dessous, nous ne retenons pas le modèle SEM car la valeur de 0,740 pour le RLMerr n’est pas significative (p = 0,3898). Par contre, les valeurs de LMlag et de RLMlag (555 et 123) sont significatives, ce qui justifie la sélection du modèle SAR.\n\nsummary(lm.LMtests(model = Modele.MCO,\n                   listw = W.Rook,\n                   test = c(\"LMlag\",\"LMerr\",\"RLMlag\",\"RLMerr\")))\n\n    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n    dependence\ndata:  \nmodel: lm(formula = NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet +\nNivVieMed, data = LyonIris)\ntest weights: listw\n \n         statistic parameter p.value    \nRSlag    554.65778         1  &lt;2e-16 ***\nRSerr    432.83282         1  &lt;2e-16 ***\nadjRSlag 122.56452         1  &lt;2e-16 ***\nadjRSerr   0.73955         1  0.3898    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n2.1.2.2 Comparaison des modèles mixtes et non mixtes\nNous avons vu qu’il existe deux modèles mixtes (SDM et SDEM). Il convient alors de vérifier si le recours d’un modèle mixte est justifié comparativement à un modèle non mixte. Dans le code ci-dessous, nous vérifions si le modèle SDM est statistiquement différent du modèle SAR avec les fonctions LR.Sarlm et anova. Les résultats signalent un écart significatif des valeurs du log-vraisemblance (26,101, p &lt; 0,001). Par conséquent, ce modèle mixte a un apport significatif.\n\n## SDM et SEM sont-ils significativement différents?\nLR.Sarlm(Modele.DurbinSpatial, Modele.SAR)\n\n\n    Likelihood ratio for spatial linear models\n\ndata:  \nLikelihood ratio = 26.101, df = 5, p-value = 8.528e-05\nsample estimates:\nLog likelihood of Modele.DurbinSpatial           Log likelihood of Modele.SAR \n                             -1353.106                              -1366.157 \n\nanova(Modele.DurbinSpatial, Modele.SAR)\n\n                     Model df    AIC  logLik Test L.Ratio    p-value\nModele.DurbinSpatial     1 13 2732.2 -1353.1    1                   \nModele.SAR               2  8 2748.3 -1366.2    2  26.101 8.5283e-05\n\n\nÀ l’inverse, la différence entre les valeurs du log-vraisemblance des modèles SDEM et SEM n’est pas significative (4,9728, p = 0,42), signalant que l’utilisation d’un modèle SDEM comparativement à un modèle SEM n’est pas nécessaire.\n\n## SDEM et SEM sont-ils significativement différents?\nLR.Sarlm(Modele.DurbinErreur, Modele.SEM)\n\n\n    Likelihood ratio for spatial linear models\n\ndata:  \nLikelihood ratio = 4.9728, df = 5, p-value = 0.4192\nsample estimates:\nLog likelihood of Modele.DurbinErreur          Log likelihood of Modele.SEM \n                            -1367.250                             -1369.737 \n\nanova(Modele.DurbinErreur, Modele.SEM)\n\n                    Model df    AIC  logLik Test L.Ratio p-value\nModele.DurbinErreur     1 13 2760.5 -1367.2    1                \nModele.SEM              2  8 2755.5 -1369.7    2  4.9728  0.4192\n\n\n\n2.1.2.3 Mesures AIC et BIC et dépendance spatiale\nLe critère d’information d’Akaike (AIC) et le critère d’information bayésien (BIC) sont largement utilisés pour évaluer la qualité d’ajustement du modèle. Plus leurs valeurs sont faibles, meilleur est le modèle. Il est donc possible de comparer leurs valeurs pour les différents modèles (MCO, SLX, SAR, SEM, SDM et SDEM). Nous pouvons aussi comparer l’autocorrélation spatiale des résidus des modèles avec le I de Moran.\n\n## Valeurs d'AIC et de BIC\nAICs &lt;- AIC(Modele.MCO, Modele.SLX, Modele.SAR, Modele.SEM, \n            Modele.DurbinSpatial, Modele.DurbinErreur)\nBICs &lt;- BIC(Modele.MCO, Modele.SLX, Modele.SAR, Modele.SEM, \n            Modele.DurbinSpatial, Modele.DurbinErreur)\n## Autocorrélation spatiale des résidus\nIMoran.MCO &lt;- moran.mc(resid(Modele.MCO), W.Rook, nsim=999)\nIMoran.SLX &lt;- moran.mc(resid(Modele.SLX), W.Rook, nsim=999)\nIMoran.SLM &lt;- moran.mc(resid(Modele.SAR), W.Rook, nsim=999)\nIMoran.SEM &lt;- moran.mc(resid(Modele.SEM), W.Rook, nsim=999)\nIMoran.DurbinS &lt;- moran.mc(resid(Modele.DurbinSpatial), W.Rook, nsim=999)\nIMoran.DurbinE &lt;- moran.mc(resid(Modele.DurbinErreur), W.Rook, nsim=999)\nMoranI.s &lt;- c(IMoran.MCO$statistic, IMoran.SLX$statistic,\n             IMoran.SLM$statistic, IMoran.SEM$statistic,\n             IMoran.DurbinS$statistic, IMoran.DurbinE$statistic)\nMoranI.p &lt;- c(IMoran.MCO$p.value, IMoran.SLX$p.value,\n             IMoran.SLM$p.value, IMoran.SEM$p.value,\n             IMoran.DurbinS$p.value, IMoran.DurbinE$p.value)\n## Tableau\nComparaison &lt;- data.frame(Modele = c(\"MCO\", \"SLX\", \"SAR\", \"SEM\", \"Durbin S\", \"Durbin E\"),\n                          AIC = AICs$AIC,\n                          BIC = BICs$BIC,\n                          dl = AICs$df,\n                          MoranI = MoranI.s,\n                          MoranIp = MoranI.p)\nComparaison\n\n    Modele      AIC      BIC dl       MoranI MoranIp\n1      MCO 3366.626 3396.212  7  0.587312061   0.001\n2      SLX 3222.594 3273.313 12  0.604660275   0.001\n3      SAR 2748.314 2782.126  8 -0.014281059   0.660\n4      SEM 2755.474 2789.286  8 -0.011826605   0.614\n5 Durbin S 2732.212 2787.157 13 -0.004612686   0.514\n6 Durbin E 2760.501 2815.446 13 -0.010361653   0.628\n\n\nQuelques lignes de code suffisent pour créer deux graphiques permettant de comparer visuellement les résultats des différents modèles (figure 2.4). Les résultats démontrent que :\n\nLes modèles MCO et SLX ont un problème de dépendance spatiale puisque leurs résidus sont significativement autocorrélés spatialement. Par conséquent, ils ne devraient pas être retenus.\nLes modèles SDM, SAR et SEM sont les plus performants avec les valeurs d’AIC les plus faibles.\n\n\nlibrary(ggplot2)\nlibrary(ggpubr)\n## Graphique pour l'autocorrélation spatiale\ng1 &lt;- ggplot(data=Comparaison, aes(x=reorder(Modele,MoranI), y=MoranI)) +\n      geom_segment(aes(x=reorder(Modele, MoranI),\n                   xend=reorder(Modele, MoranI),\n                   y=0, yend=MoranI)) +\n  geom_point( size=4,fill=\"red\",shape=21)+\n  xlab(\"Modèle\") + ylab(\"I de Moran\")+\n  labs(title=\"Autocorrélation spatiale des résidus\",\n       caption=\"Plus la valeur du I de Moran est faible, \\nmoins il y a d'autocorrélation spatiale.\")\n## Graphique pour les valeurs d'AIC\ng2 &lt;- ggplot(data=Comparaison, aes(x=reorder(Modele,AIC), y=AIC)) +\n  geom_segment(aes(x=reorder(Modele, AIC),\n                   xend=reorder(Modele, AIC),\n                   y=0, yend=AIC)) +\n  geom_point( size=4,fill=\"red\",shape=21)+\n  xlab(\"Modèle\") + ylab(\"AIC\")+\n  labs(title=\"Qualité d'ajustement du modèle\",\n       caption=\"Plus la valeur d'AIC est faible, \\nplus le modèle est performant.\")\n## Figure avec les deux graphiques\nggarrange(g1, g2)\n\n\n\nFigure 2.4: Comparaison des différents modèles"
  },
  {
    "objectID": "02-ModelesEconometrieSpatiale.html#sec-024",
    "href": "02-ModelesEconometrieSpatiale.html#sec-024",
    "title": "2  Modèles d’économétrie spatiale",
    "section": "\n2.2 Quiz de révision",
    "text": "2.2 Quiz de révision\n\n\n\n\n\nParmi les matrices de pondération spatiale ci-dessous, lesquelles sont des matrices de contiguïté?\n\n\nRelisez au besoin la ?sec-022.\n\n\n\n\n\n\nPartage d’un nœud\n\n\n\n\n\n\n\nPartage d’un segment\n\n\n\n\n\n\n\nPartage d’un nœud et ordre d’adjacence\n\n\n\n\n\n\n\nPartage d’un segment et ordre d’adjacence\n\n\n\n\n\n\n\nConnectivité selon la distance\n\n\n\n\n\n\n\n\n\n\nEn anglais, comment est appelée une matrice selon le partage d’un nœud?\n\n\nRelisez au besoin le début de la ?sec-022.\n\n\n\n\n\n\nRook\n\n\n\n\n\n\n\nQueen\n\n\n\n\n\n\n\n\n\n\nComparativement à une matrice de l’inverse de la distance, une matrice de l’inverse de la distance au carré accorde un poids plus important aux entités proches.\n\n\nRelisez au besoin la ?sec-02223.\n\n\n\n\n\n\nVrai\n\n\n\n\n\n\n\nFaux\n\n\n\n\n\n\n\n\n\n\nQuels sont les avantages de la standardisation en ligne des matrices de pondération spatiale?\n\n\nRelisez au besoin la ?sec-0223.\n\n\n\n\n\n\nLa somme de chaque ligne est égale à 1.\n\n\n\n\n\n\n\nLa somme de l’ensemble de la matrice est égale au nombre d’entités spatiales.\n\n\n\n\n\n\n\nLa standardisation permet de comparer la dépendance spatiale selon différentes matrices.\n\n\n\n\n\n\n\nLa standardisation augmente la vitesse des calculs.\n\n\n\n\n\n\n\n\n\n\nQuelle est la différence entre les deux mesures locales de Getis et Ord?\n\n\nRelisez au besoin la ?sec-0241.\n\n\n\n\n\n\nGi* tient compte à la fois des valeurs des entités voisines ou proches, mais aussi de celle de i.\n\n\n\n\n\n\n\nContrairement à Gi, Gi* a un z-score.\n\n\n\n\n\n\n\n\n\n\nParmi les quatre catégories de la typologie basée sur le nuage de points du I de Moran, lesquelles renvoient à de l’autocorrélation spatiale locale positive?\n\n\nRelisez au besoin la ?sec-0243.\n\n\n\n\n\n\nHH\n\n\n\n\n\n\n\nLL\n\n\n\n\n\n\n\nHL\n\n\n\n\n\n\n\nLH\n\n\n\n\n\n\n\n\n\n\nLe village gaulois correspond à quelle catégorie?\n\n\nRelisez au besoin la ?sec-0243.\n\n\n\n\n\n\nHH\n\n\n\n\n\n\n\nLL\n\n\n\n\n\n\n\nHL\n\n\n\n\n\n\n\nLH\n\n\n\n\n\n\n\n\n\n\nQuelles sont les trois manières de tester la significativité des mesures d’autocorrélation globales?\n\n\nRelisez au besoin la ?sec-02313.\n\n\n\n\n\n\nAvec l’hypothèse de la normalité\n\n\n\n\n\n\n\nEn relançant plusieurs fois les calculs\n\n\n\n\n\n\n\nAvec l’hypothèse de la randomisation\n\n\n\n\n\n\n\nAvec la méthode Monte-Carlo (habituellement avec 999 échantillons)\n\n\n\n\n\n\n\n\n\nVérifier votre résultat"
  },
  {
    "objectID": "02-ModelesEconometrieSpatiale.html#sec-025",
    "href": "02-ModelesEconometrieSpatiale.html#sec-025",
    "title": "2  Modèles d’économétrie spatiale",
    "section": "\n2.3 Exercices de révision",
    "text": "2.3 Exercices de révision\n\n\n\n\n\nExercice 1. Réalisation de modèles de régression autorégressifs spatiaux\n\n\n\nlibrary(sf)\nlibrary(spatialreg)\n# Matrice de contiguïté selon le partage d'un segment (Rook)\nload(\"data/chap02/DonneesLyon.Rdata\")\nRook &lt;- poly2nb(LyonIris, queen=FALSE)\nRook &lt;- poly2nb(LyonIris, queen=FALSE)\nW.Rook &lt;- nb2listw(Rook, zero.policy=TRUE, style = \"W\")\n# Modèles\nformule &lt;- \"PM25 ~  Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed\"\nModele.SLX &lt;- à compléter\nModele.SAR &lt;- à compléter\nModele.SEM &lt;- à compléter\nModele.DurbinSpatial &lt;- à compléter\nModele.DurbinErreur &lt;- à compléter\n\nCorrection à la ?sec-06071.\n\n\n\n\n\n\n\nExercice 2. Réalisation d’un modèle GAM\n\n\n\nlibrary(sf)\nlibrary(mgcv)\nload(\"data/chap02/DonneesLyon.Rdata\")\n# Ajout des coordonnées x et y\nxy &lt;- à compléter\nLyonIris$X &lt;- à compléter\nLyonIris$Y &lt;- à compléter\n# Construction du modèle\nformule &lt;- \"PM25 ~  Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed\"\nModele.GAM2 &lt;- gam(NO2 ~  à compléter\n                          à compléter,\n                          data = LyonIris)\nsummary(Modele.GAM2)\n\nCorrection à la ?sec-06072.\n\n\n\n\n\n\n\nExercice 2. Réalisation d’un modèle GWR\n\n\n\nlibrary(sf)\nlibrary(spgwr)\nload(\"data/chap02/DonneesLyon.Rdata\")\n# Ajout des coordonnées x et y\nxy &lt;- à compléter\nLyonIris$X &lt;- à compléter\nLyonIris$Y &lt;- à compléter\n# Optimisation du nombre de voisins avec le CV\nformule &lt;- \"PM25 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed\"\nbwaCV.voisins  &lt;- gwr.sel(à compléter)\n# Optimisation du nombre de voisins avec l'AIC\nbwaCV.voisins  &lt;- gwr.sel(à compléter)\n# Réalisation de la GWR\nModele.GWR &lt;- gwr(à compléter)\n# Affichage des résultats\nModele.GWR\n\nCorrection à la ?sec-06073.\n\n\n\n\n\n\nAnselin, Luc, Anil K Bera, Raymond Florax et Mann J Yoon. 1996. « Simple diagnostic tests for spatial dependence. » Regional science and urban economics 26 (1): 77‑104. https://doi.org/10.1016/0166-0462(95)02111-6.\n\n\nAnselin, Luc et Sergio J Rey. 2014. Modern spatial econometrics in practice: A guide to GeoDa, GeoDaSpace and PySAL. GeoDa Press LLC.\n\n\nApparicio, Philippe et Jérémy Gelb. 2022. Méthodes quantitatives en sciences sociales : un grand bol d’R. FabriqueREL, Licence CC BY-SA. https://serieboldr.github.io/MethodesQuantitatives/.\n\n\nBivand, Roger, Giovanni Millo et Gianfranco Piras. 2021. « A review of software for spatial econometrics in R. » Mathematics 9 (11): 1276. https://doi.org/10.3390/math9111276.\n\n\nBivand, Roger, Edzer J Pebesma, Virgilio Gómez-Rubio et Edzer Jan Pebesma. 2008. Applied spatial data analysis with R. Vol. 747248717. Springer.\n\n\nDubé, Jean et Diègo Legros. 2014. Econométrie spatiale appliquée des microdonnées. ISTE Group.\n\n\nLeSage, James P et R. Kelly Pace. 2008. An introduction to spatial econometrics. 123. CRC Press."
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-031",
    "href": "03-ModelesSpatiauxPanel.html#sec-031",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.1 Bref retour sur les modèles en panel",
    "text": "3.1 Bref retour sur les modèles en panel"
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-032",
    "href": "03-ModelesSpatiauxPanel.html#sec-032",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.2 Formulation des différents modèles spatiaux par panel",
    "text": "3.2 Formulation des différents modèles spatiaux par panel\n\n3.2.1 Description des différents modèles\n\n3.2.2 Modèle SLPDM : autocorrélation sur la variable dépendante\n\n3.2.3 Modèle SEPDM : autocorrélation sur le terme d’erreur\n\n3.2.4 Modèle SEPDM : autocorrélation sur la variable dépendante et les variables indépendantes"
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-033",
    "href": "03-ModelesSpatiauxPanel.html#sec-033",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.3 Sélection du modèle spatial par panel le plus approprié",
    "text": "3.3 Sélection du modèle spatial par panel le plus approprié"
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-034",
    "href": "03-ModelesSpatiauxPanel.html#sec-034",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.4 Mise en œuvre dans R",
    "text": "3.4 Mise en œuvre dans R"
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-035",
    "href": "03-ModelesSpatiauxPanel.html#sec-035",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.5 Quiz de révision",
    "text": "3.5 Quiz de révision\n\n\n\n\n\nQuelle est la différence entre le centre point et le point central?\n\n\nRelisez au besoin la ?sec-03112.\n\n\n\n\n\n\nLe centre moyen peut être pondéré contrairement au point central.\n\n\n\n\n\n\n\nLe point central est un point qui fait partie du semis de points initial.\n\n\n\n\n\n\n\n\n\n\nQuelles sont les quatre principales manières de représenter graphiquement la dispersion d’un semis de points?\n\n\nRelisez au besoin la ?sec-03131.\n\n\n\n\n\n\nEnveloppe convexe\n\n\n\n\n\n\n\nCentre moyen et point central\n\n\n\n\n\n\n\nRectangle construit avec les déviations standards des X et des Y\n\n\n\n\n\n\n\nDistance standard\n\n\n\n\n\n\n\nEllipse de déviation de distance standard\n\n\n\n\n\n\n\n\n\n\nQuelles sont les trois principales distributions d’un semis de points?\n\n\nRelisez au besoin la section 3.3.\n\n\n\n\n\n\nDistribution dispersée\n\n\n\n\n\n\n\nDistribution aléatoire\n\n\n\n\n\n\n\nDistribution concentrée\n\n\n\n\n\n\n\nDistribution normale\n\n\n\n\n\n\n\n\n\n\nEn analyse des quadrats, quelles sont les trois principales formes utilisées?\n\n\nRelisez au besoin la ?sec-03231.\n\n\n\n\n\n\nTriangle\n\n\n\n\n\n\n\nCarré\n\n\n\n\n\n\n\nHexagone\n\n\n\n\n\n\n\nCercle\n\n\n\n\n\n\n\n\n\n\nQuel est le paramètre influençant le plus les résultats de la méthode KDE?\n\n\nRelisez au besoin la ?sec-03421.\n\n\n\n\n\n\nLa fonction kernel utilisée\n\n\n\n\n\n\n\nLa taille du rayon d’influence\n\n\n\n\n\n\n\n\n\n\nQuelles sont les principales fonctions kernel?\n\n\nRelisez au besoin la ?sec-03421.\n\n\n\n\n\n\nGaussienne\n\n\n\n\n\n\n\nQuadratique\n\n\n\n\n\n\n\nUniforme\n\n\n\n\n\n\n\nManhattan\n\n\n\n\n\n\n\nEpanechnikov\n\n\n\n\n\n\n\n\n\nVérifier votre résultat"
  },
  {
    "objectID": "03-ModelesSpatiauxPanel.html#sec-036",
    "href": "03-ModelesSpatiauxPanel.html#sec-036",
    "title": "3  Modèles d’économétrie spatiale par panel",
    "section": "\n3.6 Exercices de révision",
    "text": "3.6 Exercices de révision\n\n\n\n\n\nExercice 1. Calcul du centre moyen et de la distance standard pour les accidents\n\n\nComplétez le code ci-dessous.\n\nlibrary(sf)\nlibrary(tmap)\n\nCorrection à la section 7.3.1.\n\n\n\n\n\n\n\nExercice 2. Calcul et cartographie de la densité des accidents dans un maillage irrégulier\n\n\nPour l’année 2021, complétez le code ci-dessous.\n\nlibrary(sf)\nlibrary(tmap)\n\nCorrection à la section 7.3.2.\n\n\n\n\n\n\n\nExercice 3. Calcul et cartographie de la densité des accidents dans un maillage régulier\n\n\nPour l’année 2021, complétez le code ci-dessous.\n\nlibrary(sf)\nlibrary(spatstat)\nlibrary(tmap)\n\nCorrection à la section 7.3.3."
  },
  {
    "objectID": "05-GWRExtensions.html#sec-051",
    "href": "05-GWRExtensions.html#sec-051",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.1 Régression géographiquement pondérée mixte",
    "text": "4.1 Régression géographiquement pondérée mixte\n\n4.1.1 Principe de base de la GWR mixte\n\n4.1.1.1 Pourquoi recourir à une GWR mixte\n\n4.1.1.2 Formulation de la GWR mixte\n\n4.1.2 Mise en oeuvre de la GWR mixte dans R"
  },
  {
    "objectID": "05-GWRExtensions.html#sec-052",
    "href": "05-GWRExtensions.html#sec-052",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.2 Régression géographiquement pondérée multiéchelle",
    "text": "4.2 Régression géographiquement pondérée multiéchelle\n\n4.2.1 Principe de base de la MGWR\n\n4.2.1.1 Pourquoi recourir à une GWR mixte\n\n4.2.1.2 Formulation de la GWR mixte\n\n4.2.2 Mise en oeuvre de la MGWR dans R"
  },
  {
    "objectID": "05-GWRExtensions.html#sec-053",
    "href": "05-GWRExtensions.html#sec-053",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.3 Régression temporellement et géographiquement pondérée",
    "text": "4.3 Régression temporellement et géographiquement pondérée\n\n4.3.1 Principe de base de la GTWR\n\n4.3.1.1 Pourquoi recourir à une GTWR\n\n4.3.1.2 Formulation de la GTWR\n\n4.3.2 Mise en oeuvre de la GTWR dans R"
  },
  {
    "objectID": "05-GWRExtensions.html#sec-054",
    "href": "05-GWRExtensions.html#sec-054",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.4 Régression géographiquement pondérée mixte avec des variables spatialement décalée",
    "text": "4.4 Régression géographiquement pondérée mixte avec des variables spatialement décalée\n\n4.4.1 Principe de base de la MGWR-SAR\n\n4.4.1.1 Pourquoi recourir à une MGWR-SAR\n\n4.4.1.2 Formulation de la MGWR-SAR\n\n4.4.2 Mise en oeuvre de la MGWR-SAR dans R"
  },
  {
    "objectID": "05-GWRExtensions.html#sec-055",
    "href": "05-GWRExtensions.html#sec-055",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.5 Quiz de révision",
    "text": "4.5 Quiz de révision\n\n\n\n\n\nUn modèle de régression géographiquement pondérée permet d’explorer\n\n\nRelisez le deuxième encadré à la ?sec-0431.\n\n\n\n\n\n\nL’instabilité spatiale du modèle\n\n\n\n\n\n\n\nLa dépendance du modèle\n\n\n\n\n\n\n\n\n\n\nUn modèle de régression géographiquement pondérée produit autant de régressions que d’entités spatiales dans le jeu de données à l’étude.\n\n\nRelisez le deuxième encadré à la ?sec-0431.\n\n\n\n\n\n\nVrai\n\n\n\n\n\n\n\nFaux\n\n\n\n\n\n\n\n\n\nVérifier votre résultat"
  },
  {
    "objectID": "05-GWRExtensions.html#sec-056",
    "href": "05-GWRExtensions.html#sec-056",
    "title": "4  Extensions de la régression géographiquement pondérée",
    "section": "\n4.6 Exercices de révision",
    "text": "4.6 Exercices de révision\n\n\n\n\n\nExercice 1. Réalisation d’un GWR classique\n\n\n\nlibrary(sf)\nlibrary(spgwr)\n\nCorrection à la section 7.4.1.\n\n\n\n\n\n\n\nExercice 2. Réalisation d’un GWR classique mixte\n\n\n\nlibrary(sf)\nlibrary(spgwr)\n\nCorrection à la section 7.4.2.\n\n\n\n\n\n\n\nExercice 3. Réalisation d’un GWR classique multiéchelle\n\n\n\nlibrary(sf)\nlibrary(spgwr)\n\nCorrection à la section 7.4.3.\n\n\n\n\n\n\nFotheringham, A Stewart, Chris Brunsdon et Martin Charlton. 2003. Geographically weighted regression: the analysis of spatially varying relationships. John Wiley & Sons.\n\n\nFotheringham, A Stewart, Ricardo Crespo et Jing Yao. 2015. « Geographical and temporal weighted regression (GTWR). » Geographical Analysis 47 (4). Wiley Online Library: 431‑452. https://doi.org/10.1111/gean.12071.\n\n\nFotheringham, A Stewart, Wenbai Yang et Wei Kang. 2017. « Multiscale geographically weighted regression (MGWR). » Annals of the American Association of Geographers 107 (6). Taylor & Francis: 1247‑1265. https://doi.org/10.1080/24694452.2017.1352480.\n\n\nGeniaux, Ghislain et Davide Martinetti. 2018. « A new method for dealing simultaneously with spatial autocorrelation and spatial heterogeneity in regression models. » Regional Science and Urban Economics 72: 74‑85. https://doi.org/10.1016/j.regsciurbeco.2017.04.001."
  },
  {
    "objectID": "06-GAM.html#sec-061",
    "href": "06-GAM.html#sec-061",
    "title": "5  Modèles généralisées additifs",
    "section": "\n5.1 Modèles généralisés additifs (GAM) avec une spline bivariée sur les coordonnées géographiques",
    "text": "5.1 Modèles généralisés additifs (GAM) avec une spline bivariée sur les coordonnées géographiques\nLes modèles généralisés additifs (Generalized additive models en anglais) permettent d’intégrer à la fois des effets linéaires et des effets non linéaires avec des splines. Ils peuvent alors être utilisés en intégrant une spline bivariée sur les coordonnées géographiques des centroïdes des entités spatiales.\n\n\n\n\n\nModèles généralisés additifs\n\n\nPour une description détaillée des modèles généralisés additifs, nous vous invitons vivement à lire le chapitre suivant (Apparicio et Gelb 2022).\n\n\n\n5.1.1 Principe de base d’un GAM intégrant l’espace\n\n5.1.1.1 Formulation d’un modèle GAM vec une spline bivariée sur les coordonnées géographiques\nAvec une spline bivariée sur les coordonnées géographiques, l’équation d’un modèle généralisé additif s’écrit :\n\\[\ng(Y) \\ = \\beta_{0} \\ + X\\beta + s(CoordX,CoordY) \\ + \\epsilon\n\\tag{5.1}\\]\navec :\n\n\n\\(y\\), la variable dépendante.\n\n\\(\\beta_{0}\\), la constante.\n\n\\(X\\), les variables indépendantes.\n\n\\(\\beta\\), les coefficients des variables dépendantes.\n\n\\(s(CoordX,CoordY)\\), spline bivariée sur les coordonnées x et y.\n\n\\(\\epsilon\\), les résidus.\n\n5.1.1.2 Pourquoi recourir à un modèle GAM avec une spline bivariée sur les coordonnées géographiques\nL’intérêt de recourir à une spline bivariée sur les coordonnées géographiques est double :\n\nContrôler l’effet de la localisation sur la variable dépendante (\\(y\\)). Les coefficients des autres variables indépendantes sont ainsi obtenus une fois l’espace pris en compte.\nÉvaluer l’effet de la localisation (patron spatial), une fois les autres variables indépendantes contrôlées. Autrement dit, toutes choses étant égales par ailleurs, quel est l’effet de la localisation sur la variable dépendante?\n\n5.1.2 Mise en oeuvre et analyse dans R\n\n5.1.2.1 Réalisation du modèle GAM\nPour construire des modèles GAM dans R, nous utilisons la fonction gam du package mgcv (Wood 2011).\n\n## Chargement des packages\nlibrary(sf)\nlibrary(spdep)\nlibrary(mgcv)\n\n## Chargement des données\nload(\"data/chap04/DonneesLyon.Rdata\")\n## Ajout des coordonnées X et Y dans LyonIris \nxy &lt;- st_coordinates(st_centroid(LyonIris))\nLyonIris$X &lt;- xy[,1]\nLyonIris$Y &lt;- xy[,2]\n## Construction du modèle MCO\nModele.MCO &lt;- lm(NO2 ~ Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed,\n                 data = LyonIris)\n## Construction du modèle GAM\nModele.GAM1 &lt;- gam(NO2 ~  Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed+\n                          s(X, Y),    # spline sur les coordonnées X, Y\n                    data = LyonIris)  # dataframe\n## Résultats du modèle\nsummary(Modele.GAM1)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nNO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + NivVieMed + s(X, \n    Y)\n\nParametric coefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 30.402313   2.156322  14.099   &lt;2e-16 ***\nPct0_14     -0.053641   0.046224  -1.160    0.246    \nPct_65      -0.056310   0.038476  -1.463    0.144    \nPct_Img      0.008033   0.035397   0.227    0.821    \nPct_brevet   0.043874   0.027518   1.594    0.112    \nNivVieMed   -0.043282   0.072461  -0.597    0.551    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n        edf Ref.df     F p-value    \ns(X,Y) 26.5  28.62 27.22  &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =  0.715   Deviance explained = 73.3%\nGCV = 18.814  Scale est. = 17.605    n = 506\n\n\nLes résultats ci-dessus signalent que la localisation a un effet très significatif puisque (s(X,Y) = 26,5 avec p &lt; 0,001). Notez que la valeur de p permet de déterminer si la spline bivariée (et donc l’espace) a ou non un effet significatif. Si la valeur de p est supérieure à 0,05, alors il n’est pas nécessaire de conserver la spline bivariée sur les coordonnées géographiques.\nDe plus, le code ci-dessous permet de constater que le modèle GAM est plus performant que le modèle linéaire multiple classique (MCO).\n\nanova(Modele.MCO, Modele.GAM1)\n\nAnalysis of Variance Table\n\nModel 1: NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + NivVieMed\nModel 2: NO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + NivVieMed + s(X, \n    Y)\n  Res.Df     RSS   Df Sum of Sq      F    Pr(&gt;F)    \n1  500.0 22346.0                                    \n2  473.5  8336.1 26.5     14010 30.029 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nNous pouvons aussi introduire une spline plus complexe en augmentant le nombre de nœuds à 40.\n\nModele.GAM2 &lt;- gam(NO2 ~  Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed+\n                          s(X, Y, k= 40), data = LyonIris)\nsummary(Modele.GAM2)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nNO2 ~ Pct0_14 + Pct_65 + Pct_Img + Pct_brevet + NivVieMed + s(X, \n    Y, k = 40)\n\nParametric coefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 30.372093   2.088160  14.545   &lt;2e-16 ***\nPct0_14     -0.055294   0.044285  -1.249   0.2124    \nPct_65      -0.049122   0.036870  -1.332   0.1834    \nPct_Img      0.002226   0.033722   0.066   0.9474    \nPct_brevet   0.052229   0.026315   1.985   0.0478 *  \nNivVieMed   -0.050991   0.070081  -0.728   0.4672    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n         edf Ref.df     F p-value    \ns(X,Y) 35.68  38.51 24.27  &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =  0.747   Deviance explained = 76.7%\nGCV = 17.014  Scale est. = 15.613    n = 506\n\n\nLa valeur plus faible d’AIC pour le second modèle GAM signale qu’il est plus performant que le premier.\n\nAIC(Modele.MCO, Modele.GAM1, Modele.GAM2)\n\n                  df      AIC\nModele.MCO   7.00000 3366.626\nModele.GAM1 33.50046 2920.682\nModele.GAM2 42.67520 2868.355\n\n\n\n5.1.2.2 Visualisation de l’effet de l’espace\nPour visualiser les prédictions du modèle dans l’espace, toutes choses étant égales par ailleurs, nous utilisons la fonction vis.gam (figure 5.1). Les contours signalent qu’au centre de Lyon, les valeurs de dioxyde d’azote sont les plus élevées et dépassent même 40 \\(\\mu\\)g/m3.\n\nvis.gam(Modele.GAM2, view=c(\"X\", \"Y\"), plot.type = \"contour\", color=\"terrain\")\n\n\n\nFigure 5.1: Visualisation des prédictions dans l’espace avec la fonction vis.gam\n\n\n\nToutefois, il est plus intéressant de la représenter dans un raster, une fois contrôlées les autres variables indépendantes. Pour ce faire, six étapes sont nécessaires :\n\nCréer une grid.\nFixer les autres paramètres à leur moyenne respective.\nCalculer la prédiction pour la localisation.\nCentrer la prédiction.\nConstruire le raster avec les prédictions.\nDécouper et cartographier le raster.\n\n\nlibrary(raster)\nlibrary(terra)\n## Étape 1 : création d'une grid pour la prédiction de 100 mètres de résolution spatiale\nXcoords &lt;- seq(min(LyonIris$X-100), max(LyonIris$X+100), by=100)\nYcoords &lt;- seq(min(LyonIris$Y-100), max(LyonIris$Y+100), by=100)\nPredDF &lt;- expand.grid(Xcoords,Ycoords)\nnames(PredDF) &lt;- c(\"X\",\"Y\")\n## Étape 2 : fixation de tous les autres paramètres à leur moyenne\nfor(Var in c(\"VegHautPrt\",\"Pct0_14\",\"Pct_65\",\"Pct_Img\",\"Pct_brevet\", \"NivVieMed\")){\n  PredDF[[Var]] &lt;- mean(LyonIris[[Var]])\n}\n## Étape 3 : calcul de la prédiction\nPredDF$PM25 &lt;- predict(Modele.GAM2,newdata=PredDF)\n## Étape 4 : centrage de la prédiction (sans la constante)\nPredDF$CenterPredPM25 &lt;- PredDF$PM25 - mean(PredDF$PM25)\n### Étape 5 : construction du raster\nrasterGAM &lt;- rasterFromXYZ(PredDF[, c(\"X\", \"Y\", \"CenterPredPM25\")])\ncrs(rasterGAM) &lt;- crs(as(LyonIris, \"Spatial\"))\nrasterGAM &lt;- rast(rasterGAM)\n### Étape 6 : découpage et cartographie du raster\nLyonIris.SpatVector &lt;- vect(LyonIris)\nrasterGAM &lt;- terra::mask(rasterGAM, LyonIris.SpatVector)\nterra::plot(rasterGAM)\n\n\n\nFigure 5.2: Visualisation de l’effet de la localisation centrée sur zéro\n\n\n\nLa figure 5.2 signale que dans le centre de Lyon, le dioxyde d’azote est plus élevé de 10 à 20 \\(\\mu\\)g/m3, toutes choses étant égales par ailleurs. À l’inverse, dans les zones périphériques, il est faible. Cela signale un net patron spatial décroissant du centre vers la périphérie.\n\n5.1.2.3 Dépendance spatiale du modèle GAM\nPar contre, bien que l’autocorrélation spatiale des résidus du modèle GAM soit plus faible que pour le modèle MCO (I de Moran de 0,337 contre 0,570 avec p &lt; 0,001), il reste que le problème de la dépendance spatiale n’est pas corrigé.\n\n## Matrice de contiguïté selon le partage d'un segment (Rook)\nRook &lt;- poly2nb(LyonIris, queen=FALSE)\nW.Rook &lt;- nb2listw(Rook, zero.policy=TRUE, style = \"W\")\n## Autocorrélation sur les résidus du modèle GAM\nmoran.mc(resid(Modele.GAM2), W.Rook, nsim=999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  resid(Modele.GAM2) \nweights: W.Rook  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.33664, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater"
  },
  {
    "objectID": "06-GAM.html#sec-062",
    "href": "06-GAM.html#sec-062",
    "title": "5  Modèles généralisées additifs",
    "section": "\n5.2 GAM avec un lissage par champ aléatoire de Markov",
    "text": "5.2 GAM avec un lissage par champ aléatoire de Markov\n\n5.2.1 Principe de base d’un avec un champ aléatoire de Markov\n\n5.2.2 Mise en oeuvre et analyse dans R\nhttps://fromthebottomoftheheap.net/2017/10/19/first-steps-with-mrf-smooths/"
  },
  {
    "objectID": "06-GAM.html#sec-063",
    "href": "06-GAM.html#sec-063",
    "title": "5  Modèles généralisées additifs",
    "section": "\n5.3 Quiz de révision",
    "text": "5.3 Quiz de révision\n\n\n\n\n\nQuels problèmes posent l’utilisation des méthodes classiques d’analyse spatiale pour des données se produisant sur un réseau?\n\n\nRelisez au besoin la section 5.1.\n\n\n\n\n\n\nLa distance euclidienne tend à sous-estimer les distances réelles.\n\n\n\n\n\n\n\nLa distance euclidienne tend à surestimer les distances réelles.\n\n\n\n\n\n\n\nLe réseau est un espace comportant davantage de dimensions qu’un espace planaire.\n\n\n\n\n\n\n\nLe réseau est un espace ne respectant pas les hypothèses d’homogénéité et d’isotropie de l’espace planaire.\n\n\n\n\n\n\n\nLes méthodes classiques analysent des portions de l’espace en dehors du réseau.\n\n\n\n\n\n\n\n\n\n\nPour adapter la méthode classique du Kernel Density Estimate, il est nécessaire de :\n\n\nRelisez au besoin le début de la section 5.2.\n\n\n\n\n\n\nUtiliser une distance réseau plutôt qu’euclidienne.\n\n\n\n\n\n\n\nN’estimer les densités que le long des lixels représentant des fragments réguliers du réseau.\n\n\n\n\n\n\n\nAdapter la fonction de Kernel pour tenir compte de la division de la masse aux intersections.\n\n\n\n\n\n\n\nAppliquer une pénalité aux portions du réseau avec peu d’évènements.\n\n\n\n\n\n\n\n\n\n\nPour une NKDE, il est uniquement possible de calculer des densités selon une bandwidth fixe.\n\n\nRelisez au besoin la ?sec-06213.\n\n\n\n\n\n\nVrai\n\n\n\n\n\n\n\nFaux\n\n\n\n\n\n\n\n\n\n\nContrairement à la KDE classique, la NKDE est moins sensible au choix de la bandwidth.\n\n\nRelisez au besoin la ?sec-06214.\n\n\n\n\n\n\nVrai\n\n\n\n\n\n\n\nFaux\n\n\n\n\n\n\n\n\n\n\nL’extension spatio-temporelle du NKDE (TNKDE) consiste à :\n\n\nRelisez au besoin la section 5.2.1.\n\n\n\n\n\n\nCalculer une somme des densités spatiales et temporelles des évènements le long du réseau.\n\n\n\n\n\n\n\nCalculer le produit des densités spatiales et temporelles des évènements le long du réseau.\n\n\n\n\n\n\n\nCalculer l’intégrale des densités spatiales et temporelles des évènements le long du réseau.\n\n\n\n\n\n\n\n\n\n\nPour une TNKDE, il est uniquement possible de calculer des densités selon une bandwidth fixe.\n\n\nRelisez au besoin la section 5.2.1.\n\n\n\n\n\n\nVrai\n\n\n\n\n\n\n\nFaux\n\n\n\n\n\n\n\n\n\n\nLes méthodes KDE, NKDE, et TNKDE peuvent être vues comme :\n\n\nRelisez au besoin la section 5.2.\n\n\n\n\n\n\nDes méthodes descriptives visant à résumer un grand ensemble d’évènements en une carte de chaleur plus facilement interprétable.\n\n\n\n\n\n\n\nDes méthodes inférentielles permettant de déterminer statistiquement la présence de points chauds ou de points froids.\n\n\n\n\n\n\n\nDes algorithmes de type boite noire réduisant la dimensionnalité des données.\n\n\n\n\n\n\n\n\n\n\nL’utilisation d’une distance réseau plutôt qu’euclidienne pour un algorithme DBSCAN risque de :\n\n\nRelisez au besoin la section 5.4.\n\n\n\n\n\n\nAugmenter la taille des groupes détectés par l’algorithme, car la recherche de voisin sera plus facile sur le réseau\n\n\n\n\n\n\n\nRéduire la taille des groupes formés par l’algorithme, car la distance euclidienne tend à sous-estimer les distances réelles sur le réseau\n\n\n\n\n\n\n\n\n\nVérifier votre résultat"
  },
  {
    "objectID": "06-GAM.html#sec-064",
    "href": "06-GAM.html#sec-064",
    "title": "5  Modèles généralisées additifs",
    "section": "\n5.4 Exercices de révision",
    "text": "5.4 Exercices de révision\n\n\n\n\n\nExercice 1. Réalisation d’un modèle GAM\n\n\n\nlibrary(sf)\nlibrary(mgcv)\nload(\"data/chap07/DonneesLyon.Rdata\")\n# Ajout des coordonnées x et y\nxy &lt;- à compléter\nLyonIris$X &lt;- à compléter\nLyonIris$Y &lt;- à compléter\n# Construction du modèle\nformule &lt;- \"PM25 ~  Pct0_14+Pct_65+Pct_Img+Pct_brevet+NivVieMed\"\nModele.GAM2 &lt;- gam(NO2 ~  à compléter\n                          à compléter,\n                          data = LyonIris)\nsummary(Modele.GAM2)\n\nCorrection à la ?sec-12072.\n\n\n\n\n\n\nApparicio, Philippe et Jérémy Gelb. 2022. Méthodes quantitatives en sciences sociales : un grand bol d’R. FabriqueREL, Licence CC BY-SA. https://serieboldr.github.io/MethodesQuantitatives/.\n\n\nWood, Simon N. 2011. « Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. » Journal of the Royal Statistical Society Series B: Statistical Methodology 73 (1): 3‑36. https://doi.org/10.1111/j.1467-9868.2010.00749.x."
  },
  {
    "objectID": "07-SEM.html",
    "href": "07-SEM.html",
    "title": "6  Modèles avec des vecteurs propres spatiaux",
    "section": "",
    "text": "Dans ce chapitre, nous abordons les modèles linéaires généralisés avec des vecteurs spatiaux proposés par Daniel Griffith (2003; Griffith, Chun et Li 2019).\n\n\n\n\n\nObjectifs d’apprentissage visés dans ce chapitre\n\n\nÀ la fin de ce chapitre, vous devriez être en mesure de :\n\nÀ compléter.\nÀ compléter.\nAnalyser les résultats produits par ce type de modèle.\nLes mettre en pratique dans R.\n\n\n\n\n\n\n\n\nListe des packages utilisés dans ce chapitre\n\n\n\nPour importer et manipuler des fichiers géographiques :\n\nsf pour importer et manipuler des données vectorielles.\n\nPour construire des cartes et des graphiques :\n\ntmap est certainement le meilleur package pour la cartographie.\nggplot2 pour construire des graphiques.\n\nPour construire des modèles GAM :\n\nspfilteR est un package dédié à ce type de modèles.\n\n\n\n\n\n\n\n\nFotheringham, A Stewart, Chris Brunsdon et Martin Charlton. 2003. Geographically weighted regression: the analysis of spatially varying relationships. John Wiley & Sons.\n\n\nGriffith, Daniel, Yongwan Chun et Bin Li. 2019. Spatial regression analysis using eigenvector spatial filtering. Academic Press."
  },
  {
    "objectID": "08-Exercices.html#sec-0601",
    "href": "08-Exercices.html#sec-0601",
    "title": "7  Correction des exercices",
    "section": "7.1 Exercices du chapitre 1",
    "text": "7.1 Exercices du chapitre 1\n\n7.1.1 Exercice 1\n\n\n7.1.2 Exercice 2\n\n\n7.1.3 Exercice 3"
  },
  {
    "objectID": "08-Exercices.html#sec-0602",
    "href": "08-Exercices.html#sec-0602",
    "title": "7  Correction des exercices",
    "section": "7.2 Exercices du chapitre 2",
    "text": "7.2 Exercices du chapitre 2\n\n7.2.1 Exercice 1\n\n\n7.2.2 Exercice 2\n\n\n7.2.3 Exercice 3"
  },
  {
    "objectID": "08-Exercices.html#sec-0603",
    "href": "08-Exercices.html#sec-0603",
    "title": "7  Correction des exercices",
    "section": "7.3 Exercices du chapitre 3",
    "text": "7.3 Exercices du chapitre 3\n\n7.3.1 Exercice 1\n\n\n7.3.2 Exercice 2\n\n\n7.3.3 Exercice 3"
  },
  {
    "objectID": "08-Exercices.html#sec-0604",
    "href": "08-Exercices.html#sec-0604",
    "title": "7  Correction des exercices",
    "section": "7.4 Exercices du chapitre 4",
    "text": "7.4 Exercices du chapitre 4\n\n7.4.1 Exercice 1\n\n\n7.4.2 Exercice 2\n\n\n7.4.3 Exercice 3"
  },
  {
    "objectID": "08-Exercices.html#sec-0605",
    "href": "08-Exercices.html#sec-0605",
    "title": "7  Correction des exercices",
    "section": "7.5 Exercices du chapitre 5",
    "text": "7.5 Exercices du chapitre 5\n\n7.5.1 Exercice 1\n\n\n7.5.2 Exercice 2\n\n\n7.5.3 Exercice 3"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Bibliographie",
    "section": "",
    "text": "Anselin, Luc, Anil K Bera, Raymond Florax et Mann J Yoon. 1996.\n« Simple diagnostic tests for spatial dependence. »\nRegional science and urban economics 26 (1): 77‑104. https://doi.org/10.1016/0166-0462(95)02111-6.\n\n\nAnselin, Luc et Sergio J Rey. 2014. Modern spatial econometrics in\npractice: A guide to GeoDa, GeoDaSpace and PySAL. GeoDa Press LLC.\n\n\nApparicio, Philippe et Jérémy Gelb. 2022. Méthodes quantitatives en\nsciences sociales : un grand bol d’R. FabriqueREL, Licence CC\nBY-SA. https://serieboldr.github.io/MethodesQuantitatives/.\n\n\nBivand, Roger, Giovanni Millo et Gianfranco Piras. 2021. « A\nreview of software for spatial econometrics in R. »\nMathematics 9 (11): 1276. https://doi.org/10.3390/math9111276.\n\n\nBivand, Roger, Edzer J Pebesma, Virgilio Gómez-Rubio et Edzer Jan\nPebesma. 2008. Applied spatial data analysis with R. Vol.\n747248717. Springer.\n\n\nDubé, Jean et Diègo Legros. 2014. Econométrie spatiale\nappliquée des microdonnées. ISTE Group.\n\n\nFotheringham, A Stewart, Chris Brunsdon et Martin Charlton. 2003.\nGeographically weighted regression: the analysis of spatially\nvarying relationships. John Wiley & Sons.\n\n\nFotheringham, A Stewart, Ricardo Crespo et Jing Yao. 2015.\n« Geographical and temporal weighted regression (GTWR). »\nGeographical Analysis 47 (4). Wiley Online Library: 431‑452. https://doi.org/10.1111/gean.12071.\n\n\nFotheringham, A Stewart, Wenbai Yang et Wei Kang. 2017.\n« Multiscale geographically weighted regression (MGWR). »\nAnnals of the American Association of Geographers 107 (6).\nTaylor & Francis: 1247‑1265. https://doi.org/10.1080/24694452.2017.1352480.\n\n\nGeniaux, Ghislain et Davide Martinetti. 2018. « A new method for\ndealing simultaneously with spatial autocorrelation and spatial\nheterogeneity in regression models. » Regional Science and\nUrban Economics 72: 74‑85. https://doi.org/10.1016/j.regsciurbeco.2017.04.001.\n\n\nGriffith, Daniel, Yongwan Chun et Bin Li. 2019. Spatial regression\nanalysis using eigenvector spatial filtering. Academic Press.\n\n\nLeSage, James P et R. Kelly Pace. 2008. An introduction to spatial\neconometrics. 123. CRC Press.\n\n\nWood, Simon N. 2011. « Fast stable restricted maximum likelihood\nand marginal likelihood estimation of semiparametric generalized linear\nmodels. » Journal of the Royal Statistical Society Series B:\nStatistical Methodology 73 (1): 3‑36. https://doi.org/10.1111/j.1467-9868.2010.00749.x."
  }
]